<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>MAGIC Manual</title><meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1-RC2" /></head><body><div class="book" title="MAGIC Manual"><div class="titlepage"><div><div><h1 class="title"><a id="id532358"></a>MAGIC Manual</h1></div><div><h2 class="subtitle">A numerical computer program for simulating self consistent dynamo action in rotating spherical shells.</h2></div></div><hr /></div><div class="toc"><p><strong>Table of Contents</strong></p><dl><dt><span class="chapter"><a href="#chap1">1. 
	Running the code
</a></span></dt><dt><span class="chapter"><a href="#chap2">2. Input</a></span></dt><dd><dl><dt><span class="section"><a href="#id532456">Grid size and truncation</a></span></dt><dd><dl><dt><span class="section"><a href="#id532460">truncation.f</a></span></dt></dl></dd><dt><span class="section"><a href="#id532616">Input parameters</a></span></dt><dd><dl><dt><span class="section"><a href="#id532722">&amp;control namelist</a></span></dt><dt><span class="section"><a href="#id533276">&amp;start_field namelist</a></span></dt><dt><span class="section"><a href="#id537536">&amp;phys_param namelist</a></span></dt><dt><span class="section"><a href="#id537992">&amp;output_control namelist</a></span></dt><dt><span class="section"><a href="#id540320">&amp;mantle namelist  </a></span></dt><dt><span class="section"><a href="#id540395">&amp;inner_core namelist  </a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#chap3">3. Output</a></span></dt><dt><span class="chapter"><a href="#chap4">4. Subroutines</a></span></dt><dd><dl><dt><span class="section"><a href="#id543996">Main code</a></span></dt><dt><span class="section"><a href="#id561887">Common-blocks</a></span></dt></dl></dd></dl></div><div class="chapter" title="Chapter 1.  Running the code"><div class="titlepage"><div><div><h2 class="title"><a id="chap1"></a>Chapter 1. 
	Running the code
</h2></div></div></div><p>
	The dynamo code can be downloaded from the ftp-server of the Institut for Geophysics in Göttingen: </p><p>
	<a class="ulink" href="ftp://www.mps.mpg.de/outgoing/wicht/MAGIC3" target="_top">ftp://www.mps.mpg.de/outgoing/wicht/MAGIC3</a></p><p>
	The code consists of a fairly large number of subroutines contained in the tar-file MAGIC3_??.tar.gz. Uncompressing and un-tarig the file will create a directory /MAGIC3_??/ that contains all necessary files including the make-file <code class="filename">magic.make</code>. Usage of this makefile for compiling and linking is strongly recommended. It has to be adapted to the specific situation, notably compiler commands and compiler options have to be changed. See the file magicCompilers for additional hints. As an example, the compiler for GWDS1, in Gottingen, is <span class="emphasis"><em>ifort</em></span>. The command</p><p>
	<code class="filename">make -f magic.make</code></p><p>
	will construct the executable magic.exe .</p><p>
	The code can be run by using a shell script. Examples can be found in the subdirectory /runTest/ that created by uncompressing and un-taring runTest.tar.gz . Alternatively to using scripts the input parameters can be supplied via STDIN, preferably by employing a file containing the namelists-parameters: </p><p>
	<code class="filename">magic.exe &lt; namelists</code></p><p>
	Note that the scripts in /runTest/ aswell as magic.exe will have to be made executable before running them in a unix eviroment.</p><p>
Use /runTest/ for testing your code implementation. The test runs should reproduce the output-files with extensions (TAG) Uli1P1, Uli1P2, and so forth. Directory /runTest/ contains runs for up to 64 processors, results are supplied for up to eight processors. At the end of each <code class="filename">log.TAG</code> file run-times can be found that allow you to jugde speed and scaling of you computer. The listed results have been computed with AMD Opteron 875 2.2 Ghz processors. Note that the results may differ in the last two digits or so when run on different systems.
</p><p>
	The number of input parameters has grown to more than 100. But dont be confused by this number. All parameters are set internally to a (hopefully) useful default value. You may start with just changing physical parameters (Rayleigh number, Ekman number,...) to the desired values and then checking the truncation. Use the test scripts as a guideline for preparing other input files. Any log-file contains a list of all input parameters in the required format, which can be used as a basis for a more general input file. But see the explanation on input in chapter 2.</p><p>
	Unfortunately, this manual is quite outdated by now. I didn’t find the time for an update for some years now. The following chapters can nevertheless give you an idea of the most important input parameters. Newer additions mostly concern new output options and new model analysis.
</p><p>
	During a run, the code can be controlled by a file created when the simulation starts, called <code class="filename">signal.TAG</code>. Opening this file, changing the word NOT to END and saving the change, will cause the code to finish the current time step and write all the output as if it was programed to finish at that time from the start. The run can be continued later by using the restart file produced by this run. It also possible to change the word NOT to GRA during a run to produce a graphic output file, but it should be changed back to NOT after the graphic file is obtained, or the program will keep writing graphic outputs for each following time step.
</p></div><div class="chapter" title="Chapter 2. Input"><div class="titlepage"><div><div><h2 class="title"><a id="chap2"></a>Chapter 2. Input</h2></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl><dt><span class="section"><a href="#id532456">Grid size and truncation</a></span></dt><dd><dl><dt><span class="section"><a href="#id532460">truncation.f</a></span></dt></dl></dd><dt><span class="section"><a href="#id532616">Input parameters</a></span></dt><dd><dl><dt><span class="section"><a href="#id532722">&amp;control namelist</a></span></dt><dt><span class="section"><a href="#id533276">&amp;start_field namelist</a></span></dt><dt><span class="section"><a href="#id537536">&amp;phys_param namelist</a></span></dt><dt><span class="section"><a href="#id537992">&amp;output_control namelist</a></span></dt><dt><span class="section"><a href="#id540320">&amp;mantle namelist  </a></span></dt><dt><span class="section"><a href="#id540395">&amp;inner_core namelist  </a></span></dt></dl></dd></dl></div><div class="section" title="Grid size and truncation"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id532456"></a>Grid size and truncation</h2></div></div></div><div class="section" title="truncation.f"><div class="titlepage"><div><div><h3 class="title"><a id="id532460"></a>truncation.f</h3></div></div></div><p>
			Parameters concerning the numerical grid size are defined in a file called <code class="filename">truncation.f</code>. This file is included into the code at compilation. Thus, re-compilation is necessary for any changes in the grid. In radial direction the code uses a representation in Chebyshev polynomi­als when radial derivatives or integrals over radius have to be calculated. The number of radial grid points and the degree of the Chebyshev repre­sentation can be chosen independently for the inner and outer core. In longitudinal and latitudinal direction the code switches back and forth between the physical grid and a representation in spherical harmonic functions. The size of the longitude-latitude grid is determined by the num­ber of grid points in longitudinal direction n_phi_tot. The latitude-grid uses exactly n_phi_tot/2 points.
		</p><p>
			Degree lmax  and order mmax  of the spherical harmonic expansion are de­termined by the dealiazing parameter nalias:
			</p><div class="informalequation"><span class="mathphrase">αl<sub>max</sub>=(nalias*n_theta_max)/30</span></div><p>
		</p><p>
			with n=1,2,3... The parameter minc defines the symmetry in longitude di­rection. For a minc-fold symmetry only orders that are a multiple of minc contribute to the representation in spherical harmonic functions. </p><p title="n_r_max"><strong>n_r_max. </strong>
				Integer, number of grid points in outer core <span class="mathphrase">[r<sub>i</sub>,r<sub>o</sub>]</span>.
			
                                    n_r_max-1 must be a multiple of 4.
			</p><p title="n_r_max"><strong>n_r_max. </strong>
				Integer, no. of Chebyshev-polynomials in OC, maximum Chebyshev degree used is n_cheb_max-1.
			
                                    n_cheb_max ≤ n_r_max
			</p><p title="n_phi_tot"><strong>n_phi_tot. </strong>
				Integer, no. of longitudinal grid points.
			
                                    n_phi_tot must be a multiple of minc.
			
                                    n_phi_tot/minc must be a multiple of 4.
			
                                    n_phi_tot must be a multiple of 16.
			</p><p title="n_r_ic_max"><strong>n_r_ic_max. </strong>
				Integer, no. of radial grid points in IC <span class="mathphrase">[0,r<sub>i</sub>]</span>.
			
                                    n_r_ic_max-1 must be a multiple of 4.
			</p><p title="n_cheb_ic_max"><strong>n_cheb_ic_max. </strong>
				Integer, no. Chebyshev-polynomials in IC, only even Chebs used in inner core with maximum degree   2 n_cheb_ic_max -2 .
			
                                    n_cheb_ic_max ≤ n_r_ic_max
			</p><p title="minc"><strong>minc. </strong>
				Integer, basic wavenumber for the longitudinal sym­metry, orders m used in the spherical harmonic expansion are a multiple of minc.
			</p><p title="nalias"><strong>nalias. </strong>
				Integer, parameter determining antialiasing used in the spherical harmonic representation.
			</p></div></div><div class="section" title="Input parameters"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id532616"></a>Input parameters</h2></div></div></div><p>
		True runtime input parameters are read from STDIN as namelists, a Fort­ran feature. A namelist is identified by its unique name &amp;name. The name-statement is followed by the parameters that are part of the namelist in the format <span class="emphasis"><em>parameter=value,</em></span>. The namelist is closed by a backslash. The subroutine <code class="filename">s_default_namelist.f</code> defines a default value for each pa­rameter. Only the parameters whose value should differ from its default have to be stated in the namelist.
	</p><p>
		An example for the short namelist defining inner core parameters is:
		</p><table border="0" summary="Simple list" class="simplelist"><tr><td><code class="filename">&amp;inner_core</code></td></tr><tr><td>  <code class="filename">sigma_ratio = 1.0,</code></td></tr><tr><td>  <code class="filename">nRotIc         = 1/</code></td></tr></table><p>
	</p><p>
		Comas can be used to seperate namelist entries since they are not interpreted by the code.
	­</p><p>
		Magic uses six namelists:
		</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><span class="command"><strong>&amp;control</strong></span> for control parameters and numerical  parameters.</li><li class="listitem"><span class="command"><strong>&amp;phys_param</strong></span> for the physical parameters.</li><li class="listitem"><span class="command"><strong>&amp;start_field</strong></span> to define the starting fields.</li><li class="listitem"><span class="command"><strong>&amp;output_control</strong></span> for defining the output.</li><li class="listitem"><span class="command"><strong>&amp;mantle</strong></span> for setting mantle parameters.</li><li class="listitem"><span class="command"><strong>&amp;inner_core</strong></span> for setting inner core parameters.</li></ol></div><p>
	­</p><div class="section" title="&amp;control namelist"><div class="titlepage"><div><div><h3 class="title"><a id="id532722"></a>&amp;control namelist</h3></div></div></div><p>
			This namelist defines the numerical parameters of the problem plus the variables that control and organize the run. An exception are the grid-size and truncation parameters, that have to be set before compiling the code.
		</p><p title="mode"><strong>mode. </strong>
				Integer, controls the type of calculation performed.
			</p><div class="variablelist"><dl><dt><span class="term"><code class="filename">mode=0</code></span></dt><dd>Selfconsistent dynamo</dd><dt><span class="term"><code class="filename">mode=1</code></span></dt><dd>Convection</dd><dt><span class="term"><code class="filename">mode=2</code></span></dt><dd>Kinematic dynamo</dd><dt><span class="term"><code class="filename">mode=3</code></span></dt><dd>Magnetic decay modes</dd><dt><span class="term"><code class="filename">mode=4</code></span></dt><dd>Magneto convection</dd><dt><span class="term"><code class="filename">mode=5</code></span></dt><dd>Linear onset of convection</dd><dt><span class="term"><code class="filename">mode=6</code></span></dt><dd>Selfconsistent dynamo, but with no Lorentz force</dd><dt><span class="term"><code class="filename">mode=7</code></span></dt><dd>Super-rotating inner core or mantle, no convection and no magnetic field</dd><dt><span class="term"><code class="filename">mode=8</code></span></dt><dd>Super-rotating inner core or mantle, no convection</dd><dt><span class="term"><code class="filename">mode=9</code></span></dt><dd>Super-rotating inner core or mantle, no convection and no Lorentz force</dd><dt><span class="term"><code class="filename">mode=10</code></span></dt><dd>Super-rotating inner core or mantle, no convection, no magnetic field, no Lorentz force and no advection</dd></dl></div><p title="tag"><strong>tag. </strong>
				Character string, used as extension for all output files.
			</p><p title="n_time_steps"><strong>n_time_steps. </strong>
				Integer, no. of time steps to be performed.
			</p><p title="n_tScale"><strong>n_tScale. </strong>
				Integer, determines time scaling.
			</p><div class="variablelist"><dl><dt><span class="term"><code class="filename">n_tScale=0</code></span></dt><dd>Use viscous time scale.</dd><dt><span class="term"><code class="filename">n_tScale=1</code></span></dt><dd>Use magnetic time scale.</dd><dt><span class="term"><code class="filename">n_tScale=2</code></span></dt><dd>Use thermal time scale.</dd></dl></div><p title="n_lScale"><strong>n_lScale. </strong>
				Integer, determines length scaling.
			</p><div class="variablelist"><dl><dt><span class="term"><code class="filename">n_lScale=0</code></span></dt><dd>Use outer core.</dd><dt><span class="term"><code class="filename">n_lScale=1</code></span></dt><dd>Use total core. (devia ser 1+radratio ?)</dd></dl></div><p title="alpha"><strong>alpha. </strong>
				Real, weight used for current time step in implicit time step.
			</p><p title="enscale"><strong>enscale. </strong>
				Real, scaling for energy output.
			</p><p title="l_update_v=.TRUE."><strong>l_update_v=.TRUE. </strong>
				Logical, time step velocity field.
			</p><p title="l_update_v=.TRUE."><strong>l_update_v=.TRUE. </strong>
				Logical, time step magnetic field.
			</p><p title="l_update_s=.TRUE."><strong>l_update_s=.TRUE. </strong>
				Logical, time step entropy.
			</p><div class="section" title="Time step control"><div class="titlepage"><div><div><h4 class="title"><a id="id533063"></a>Time step control</h4></div></div></div><p>
		                   A modified courant criteria including a modified Alfen-velocity is used to account for the magnetic field. The relative and absolute importance of flow and Alfen-velocity can be controled by <span class="emphasis"><em>courfac</em></span> and <span class="emphasis"><em>alffac</em></span> respec­tively. 
			</p><p title="dtstart"><strong>dtstart. </strong>
					Real, used as initial time step if start solution is initialized (see below) and <span class="emphasis"><em>dtstart&gt;0</em></span>.
				</p><p title="dtmax"><strong>dtmax. </strong>
					Real, maximum allowed time step <span class="emphasis"><em>δt</em></span>. If <span class="emphasis"><em>δt &gt; dtmax</em></span> time step is decreased to at least <span class="emphasis"><em>dtmax</em></span> (See routine <code class="filename">s_dt_courant.f</code> ). Run is stopped if <span class="emphasis"><em>δt &lt; dtmin</em></span>, <span class="emphasis"><em><span class="mathphrase">dtmin=10<sup>-6</sup>dtmax</span></em></span> in present version. This could be changed in <code class="filename">s_input.f</code>. 
				</p><p title="courfac"><strong>courfac. </strong>
					Real, used to scale velocity in courant criteria.
				</p><p title="alffac"><strong>alffac. </strong>
					Real, used to scale Alfen-velocity in courant crite­ria.
				</p><p title="n_cour_step"><strong>n_cour_step. </strong>
					Integer, no. of time steps before consecutive checking of courant criteria.
				
					Note: the courant criteria is checked always after the time step has been changed if <span class="emphasis"><em>n_cour_step&gt;0</em></span>.
				</p></div><div class="section" title="Hyperdiffusivity"><div class="titlepage"><div><div><h4 class="title"><a id="id533180"></a>Hyperdiffusivity</h4></div></div></div><p>
				Hyperdiffusion is applied by multiplying a factor of the form
				</p><div class="informalequation"><span class="mathphrase">d(l) = 1 + D[(l+1-l<sub>hd</sub>)/(l<sub>max</sub>+1-l<sub>hd</sub>)]<sup>β</sup></span></div><p>
	                           to diffusion terms for degrees <span class="emphasis"><em>l ≥ l<sub>hd</sub></em></span>.
			</p><p title="difnu"><strong>difnu. </strong>
					Real, amplitude <span class="emphasis"><em>D</em></span> of viscous and thermal hyperdiffu­sion.
				</p><p title="difeta"><strong>difeta. </strong>
					Real, amplitude <span class="emphasis"><em>D</em></span> of magnetic hyperdiffusion.
				</p><p title="ldif"><strong>ldif. </strong>
					Integer, degree <span class="emphasis"><em>l<sub>hd</sub></em></span> where hyperdiffusion starts to act.
				</p><p title="ldifexp"><strong>ldifexp. </strong>
					Integer, exponent β of hyperdiffusion.
				</p></div></div><div class="section" title="&amp;start_field namelist"><div class="titlepage"><div><div><h3 class="title"><a id="id533276"></a>&amp;start_field namelist</h3></div></div></div><p>
			Controls whether a start field from a previous solution should be used, or a specific field should be initialized.
		</p><div class="section" title="Input of start fields:"><div class="titlepage"><div><div><h4 class="title"><a id="id533286"></a>Input of start fields:</h4></div></div></div><p title="l_start_file"><strong>l_start_file. </strong>
					Logical to tell the code that it should use a startfile.
				</p><div class="variablelist"><dl><dt><span class="term"><code class="filename">l_start_file=.true.</code></span></dt><dd>Read start fields from file <span class="emphasis"><em>start_file</em></span>.</dd><dt><span class="term"><code class="filename">l_start_file=.false.</code></span></dt><dd>Construct initial field.</dd></dl></div><p title="start_file"><strong>start_file. </strong>
					Character string, name of startfile.
				</p><p title="inform"><strong>inform. </strong>
					Integer, gives format of fields in start_file.
				</p><div class="variablelist"><dl><dt><span class="term"><code class="filename">inform=0</code></span></dt><dd>Oldest format used by Christensen.</dd><dt><span class="term"><code class="filename">inform=1</code></span></dt><dd>Newer format used by Christensen.</dd><dt><span class="term"><code class="filename">inform=2</code></span></dt><dd>Inner core information added by JW.</dd><dt><span class="term"><code class="filename">inform=3</code></span></dt><dd>Lorentz-torques added by JW.</dd><dt><span class="term"><code class="filename">inform=4</code></span></dt><dd>?</dd><dt><span class="term"><code class="filename">inform=5</code></span></dt><dd>?</dd><dt><span class="term"><code class="filename">inform=6</code></span></dt><dd>?</dd><dt><span class="term"><code class="filename">inform=7</code></span></dt><dd>?</dd><dt><span class="term"><code class="filename">inform=8</code></span></dt><dd>?</dd></dl></div><p title="l_reset_t=.true."><strong>l_reset_t=.true. </strong>
					Logical, time of start file is reset to zero.
				</p><p title="scale_s"><strong>scale_s. </strong>
					Real, input entropy field from start_file is scaled with scale_s.
				</p><p title="scale_v"><strong>scale_v. </strong>
					Real, input velocity field from start_file is scaled with scale_v.
				</p><p title="scale_b"><strong>scale_b. </strong>
					Real, input magnetic field from start_file is scaled with scale_b.
				</p><p title="tipdipole"><strong>tipdipole. </strong>
					Real, used to add non-axisymmetric disturbances to a startsolution if non-axisymmetric parts have been lost due to mapping to a different symmetry. A (l=1,m=1) entropy term is added with:
				
					Real, used to add non-axisymmetric disturbances to a startsolution if non-axisymmetric parts have been lost due to mapping to a different symmetry. A (l=1,m=1) entropy term is added with:
					</p><div class="informalequation"><span class="mathphrase">S<sub>10</sub>(r) = <span class="emphasis"><em>tipdipole</em></span> sin(π(r-r<sub>i</sub>))</span></div><p title="tipdipole">
					If a magnetic field without an m=1 term is mapped into a field that permits this term, the code adds the respective poloidal field using the (l=1,m=0) poloi­dal magnetic field and scaling it with <span class="emphasis"><em>tipdipole</em></span>.
				</p></div><div class="section" title="Initialization of Entropy:"><div class="titlepage"><div><div><h4 class="title"><a id="id533563"></a>Initialization of Entropy:</h4></div></div></div><p>
				The heat equation with heat sources give by  epsc0 is solved for laterally symmetric term (l=0,m=0) to get its radial dependence. Two other laterally variing terms can be initialized. Their radial dependence is taken to be:
				</p><div class="informalequation"><span class="mathphrase">s(r) ≈ 1-3x<sup>2</sup>+x<sup>4</sup>-x<sup>6</sup></span></div><p>
				Thus the field is zero at r<sub>i</sub> and r<sub>o</sub>, and has a maximum amplitude of <span class="emphasis"><em>amp_s1</em></span> or <span class="emphasis"><em>amp_s2</em></span> at midradius r<sub>i</sub>+1/2.
			</p><p title="init_s1"><strong>init_s1. </strong>
					Integer, controls first harmonic to be used as an initial entropy.
				</p><div class="variablelist"><dl><dt><span class="term"><code class="filename">init_s1=0</code></span></dt><dd>Nothing initialized.</dd><dt><span class="term"><code class="filename">init_s1&lt;100</code></span></dt><dd>Random noise with amplitude <span class="emphasis"><em>amp_s1</em></span>. See <code class="filename">s_init_s.f</code> for details.</dd><dt><span class="term"><code class="filename">init_s1≥100</code></span></dt><dd>Initialisation of mode with order given by the last two digits of <span class="emphasis"><em>init_s1</em></span> and the degree given by the first one or two digits.</dd></dl></div><p title="init_s2"><strong>init_s2. </strong>
					Integer, can be used to initialize second harmonic. See <span class="emphasis"><em>init_s1</em></span> above.
				</p><p title="amp_s1, amp_s2"><strong>amp_s1, amp_s2. </strong>
					Real, amplitudes used for entropy initialization. See above.
				</p></div><div class="section" title="Initialization of magnetic field:"><div class="titlepage"><div><div><h4 class="title"><a id="id533701"></a>Initialization of magnetic field:</h4></div></div></div><p title="init_b1"><strong>init_b1. </strong>
					Integer, controls initialization of magnetic field. 
				</p><div class="variablelist"><dl><dt><span class="term"><code class="filename">init_b1&lt;0</code></span></dt><dd>Random noise initialization of all (l,m) modes, except for (l=0,m=0).</dd><dt><span class="term"><code class="filename">init_b1=0</code></span></dt><dd>No initial magnetic field.</dd><dt><span class="term"><code class="filename">init_b1=1</code></span></dt><dd>Diffusive toroidal field initialized. Mode determined by <span class="emphasis"><em>imagcon</em></span>.</dd><dt><span class="term"><code class="filename">init_b1=2</code></span></dt><dd>(l=1,m=0) toroidal field with a maximum field strength of amp_b1. Radial dependence is chosen, so that the field vanishes at inner and outer. Insulating inner core:
							<div class="informalequation"><span class="mathphrase">t(r) ≈ r sin(π(r-r<sub>o</sub>))</span></div>
							Conducting inner core:
							<div class="informalequation"><span class="mathphrase">t(r) ≈ r sin(π(r/r<sub>o</sub>))</span></div></dd><dt><span class="term"><code class="filename">init_b1=3</code></span></dt><dd>(l=1,m=0) poloidal field whose field strength is amp_b1 at <span class="emphasis"><em>r=r<sub>i</sub></em></span>. The radial dependence is cho­sen so that the current density <span class="emphasis"><em>j</em></span> is independend of <span class="emphasis"><em>r</em></span>:
							<div class="informalequation"><span class="mathphrase">∂<sub>r</sub>j = 0</span></div>
						(l=2,m=0) toroidal field with maximum strength <span class="emphasis"><em>amp_b1</em></span>. Radial dependence as for <span class="emphasis"><em>init_b1</em></span>=2.</dd><dt><span class="term"><code class="filename">init_b1=4</code></span></dt><dd>(l=1,m=0) poloidal field as if the core where an insu­lator (potential field). Field strength at <span class="emphasis"><em>r = r<sub>i</sub></em></span> is again given by <span class="emphasis"><em>amp_b1</em></span>.</dd><dt><span class="term"><code class="filename">init_b1=5</code></span></dt><dd>(l=1,m=0) poloidal field with field strength <span class="emphasis"><em>amp_b1</em></span> at <span class="emphasis"><em>r = <sub>r</sub></em></span>. Radial dependence again defined by<span class="mathphrase">∂<sub>r</sub>j = 0</span>.</dd><dt><span class="term"><code class="filename">init_b1=6</code></span></dt><dd>(l=1,m=0) poloidal field independend of r.</dd><dt><span class="term"><code class="filename">init_b1=7</code></span></dt><dd>(l=1,m=0) poloidal field which fulfills symmetry condition in IC:
							<div class="informalequation"><span class="mathphrase">s(r) ≈ (r/r<sub>i</sub>)<sup>2</sup>(1-3/5(r/r<sub>o</sub>)<sup>2</sup>)</span></div>
							Field strength at <span class="emphasis"><em>r = r<sub>o</sub></em></span> given by <span class="emphasis"><em>amp_b1</em></span>.</dd><dt><span class="term"><code class="filename">init_b1=8</code></span></dt><dd>Same poloidal field as for <span class="emphasis"><em>init_b1=7</em></span>. Toroidal field fulfills symmetry conditions in inner core and has a field strength of <span class="emphasis"><em>amp_b1</em></span> at <span class="emphasis"><em>r = r<sub>i</sub></em></span>:
							<div class="informalequation"><span class="mathphrase">t(r) ≈ (r/r<sub>i</sub>)<sup>3</sup>(1-(r/r<sub>o</sub>)<sup>2</sup>)</span></div>
							Field strength at <span class="emphasis"><em>r = r<sub>o</sub></em></span> given by <span class="emphasis"><em>amp_b1</em></span>.</dd><dt><span class="term"><code class="filename">init_b1=9</code></span></dt><dd>(l=2,m=0) poloidal field, which is a potential field at the CMB.</dd><dt><span class="term"><code class="filename">init_b1=10</code></span></dt><dd>Only equatorial dipole.</dd><dt><span class="term"><code class="filename">init_b1=11</code></span></dt><dd>Axial and equatorial dipole.</dd><dt><span class="term"><code class="filename">init_b1=21</code></span></dt><dd>Toroidal field created by inner core rotation, equatorial symmetric. (l=1,m=0)</dd><dt><span class="term"><code class="filename">init_b1=22</code></span></dt><dd>Toroidal field created by inner core rotation, equatorial symmetric. (l=2,m=0)</dd></dl></div><p title="imagcon"><strong>imagcon. </strong>
				Determines imposed magnetic field for magnetocon­vection. The magnetic field is imposed at boundaries. 
				</p><div class="variablelist"><dl><dt><span class="term">imagcon=0</span></dt><dd>No magnetoconvection.</dd><dt><span class="term">imagcon&lt;0</span></dt><dd>Axial poloidal dipole imposed at ICB with maximum magnetic field strength <span class="emphasis"><em>amp_b1</em></span>.</dd><dt><span class="term">imagcon=1</span></dt><dd>(l=2,m=0) toroidal field imposed at ICB with maxi­mum field amplitude <span class="emphasis"><em>amp_b1</em></span> and zero amplitude at CMB.</dd><dt><span class="term">imagcon=10</span></dt><dd>(l=2,m=0) toroidal field imposed at ICB and CMB with maximum amplitude <span class="emphasis"><em>amp_b1</em></span> at both bounda­ries.</dd><dt><span class="term">imagcon=11</span></dt><dd>Same as <span class="emphasis"><em>imagcon=10</em></span> but the maximum amplitude is now <span class="emphasis"><em>amp_b1</em></span> at the ICB and <span class="emphasis"><em>-amp_b1</em></span> at the CMB.</dd><dt><span class="term">imagcon=12</span></dt><dd>(l=1,m=0) toroidal field with a maximum amplitude of <span class="emphasis"><em>amp_b1</em></span> at the ICB and the CMB. </dd></dl></div><p title="amp_b1"><strong>amp_b1. </strong>
				Real amplitude for magnetic field initialization.
			</p></div><div class="section" title="Initialization of velocity field:"><div class="titlepage"><div><div><h4 class="title"><a id="id537512"></a>Initialization of velocity field:</h4></div></div></div><p title="init_v1"><strong>init_v1. </strong>I
				Integer to control velocity field initialization. Not used so far. 
			</p><p title="amp_v1"><strong>amp_v1. </strong>
				Real amplitude for velocity field initialization. 
			</p></div></div><div class="section" title="&amp;phys_param namelist"><div class="titlepage"><div><div><h3 class="title"><a id="id537536"></a>&amp;phys_param namelist</h3></div></div></div><div class="section" title="Dimensionless Parameters:"><div class="titlepage"><div><div><h4 class="title"><a id="id537542"></a>Dimensionless Parameters:</h4></div></div></div><p title="ra"><strong>ra. </strong>
				Real, Rayleigh number 
			</p><p title="ek"><strong>ek . </strong>
				Real, Ekman number 
			</p><p title="pr"><strong>pr . </strong>
				Real, Prandtl number 
			</p><p title="prmag"><strong>prmag . </strong>
				Real, magnetic Prandtl number 
			</p><p title="epsc0"><strong>epsc0 . </strong>
				Real, dimensionless internal heating rate density 
			</p><p title="radratio"><strong>radratio . </strong>
				Real, inner core radius/outer core radius 
			</p><p title="strat"><strong>strat. </strong>
				Stratification parameter for the density background profile <span class="mathphrase">N<sub>ρ</sub>=ln(ρ<sub>ic</sub>/ρ<sub>oc</sub>)</span>. 
			</p><p title="polind"><strong>polind. </strong>
				Polytropic index <code class="filename">m</code>:  <span class="mathphrase">ρ=T<sup>m</sup></span>. 
			</p></div><div class="section" title="Boundary conditions:"><div class="titlepage"><div><div><h4 class="title"><a id="id537636"></a>Boundary conditions:</h4></div></div></div><p title="ktops"><strong>ktops. </strong>
				Integer, outer heat boundary condition 
				</p><div class="variablelist"><dl><dt><span class="term">ktops=1 </span></dt><dd>Fixed entropy at outer boundary. </dd><dt><span class="term">ktops=2 </span></dt><dd>Fixed heat flux at outer boundary.</dd></dl></div><p title="kbots"><strong>kbots. </strong>
				Integer, inner heat boundary condition 
				</p><div class="variablelist"><dl><dt><span class="term">kbots=1</span></dt><dd>Fixed entropy at inner boundary.</dd><dt><span class="term">kbots=2 </span></dt><dd>Fixed heat flux at inner boundary. </dd></dl></div><p title="ktopv"><strong>ktopv . </strong>
				Integer, outer velocity boundary condition 
				</p><div class="variablelist"><dl><dt><span class="term">ktopv=1</span></dt><dd>Stress free outer boundary.</dd><dt><span class="term">ktopv=2</span></dt><dd>No-slip outer boundary. </dd></dl></div><p title="kbotv"><strong>kbotv . </strong>
				Integer, inner velocity boundary condition.
				</p><div class="variablelist"><dl><dt><span class="term">kbotv=1 </span></dt><dd>Stress free inner boundary. </dd><dt><span class="term">kbotv=2 </span></dt><dd>No-slip inner boundary. </dd></dl></div><p title="ktopb"><strong>ktopb . </strong>
				Integer, outer magnetic boundary condition. 
				</p><div class="variablelist"><dl><dt><span class="term">ktopb=1</span></dt><dd>Insulating outer boundary. </dd><dt><span class="term">ktopb=2 </span></dt><dd>Perfectly conducting outer boundary. </dd><dt><span class="term">ktopb=3 </span></dt><dd>Finitely conducting outer boundary. </dd></dl></div><p title="kbotb"><strong>kbotb. </strong>
				Integer, inner magetic boundary condition. 
				</p><div class="variablelist"><dl><dt><span class="term">kbotb=1 </span></dt><dd>Insulating inner boundary. </dd><dt><span class="term">kbotb=2 </span></dt><dd>Perfectly conducting inner boundary. </dd><dt><span class="term">kbotb=3 </span></dt><dd>Finitely conducting inner boundary. </dd></dl></div><p title="s_top"><strong>s_top. </strong>
				Real array of lateraly variing outer heat boundary conditions. Each four consecutive numbers are inter­preted as follows:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">Spherical harmonic degree</li><li class="listitem">Spherical harmonic order</li><li class="listitem">Real amplitude (cos contribution)</li><li class="listitem">Imaginary amplitude (sin contribution)</li></ol></div><p title="s_top">
				For example, if the boundary condition should be a combination of an (l=1,m=0) sherical harmonic with the amplitude 1 and an (l=2,m=1) spherical harmonic with the amplitude (0.5,0.5) the respective namelist entry could read: 
				
	                           	<span class="emphasis"><em>s_top</em></span> = 1, 0,  1.0, 0.0, 2, 1, 0.5, 0.5, 
				
					The comas could be left away. 
				</p><p title="s_bot"><strong>s_bot. </strong>
				Same as <span class="emphasis"><em>s_top</em></span> but for the bottom boundary.
			</p><p title="impS"><strong>impS. </strong>
				Flag to indicate if there is a localized entropy disturbance, imposed at the CMB.
				
					The number of these input boundary conditions is stored in <span class="emphasis"><em>n_impS</em></span> (the maximum allowed is 20), and it's given by the number of <span class="emphasis"><em>sCMB</em></span> defined in the namelist.
				
					The default value of <span class="emphasis"><em>impS</em></span> is zero (no entropy disturbance). If it is set in the namelist for an integer greater than zero, then <span class="emphasis"><em>sCMB</em></span> has to be also defined in the namelist, as shown below.
				</p><p title="sCMB"><strong>sCMB. </strong>
				Real array of CMB heat boundary conditions (similar to the case of <span class="emphasis"><em>s_bot</em></span> and <span class="emphasis"><em>s_top</em></span>). Each four consecutive numbers are inter­preted as follows:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">Highest amplitude value of the entropy boundary condition, stored in array peakS[20]. When <span class="emphasis"><em>impS&lt;0</em></span>, <span class="emphasis"><em>peakS</em></span> is a relative amplitude in comparison to the <span class="emphasis"><em>(l=0,m=0)</em></span> contribution (for example, the case <span class="emphasis"><em>s_top= 0 0 -1 0</em></span>).</li><li class="listitem">Theta coordinate (input has to be given in degrees), stored in array thetaS[20].</li><li class="listitem">Phi coordinate (input has to be given in degrees), stored in array phiS[20].</li><li class="listitem">Angular width (input has to be given in degrees), stored in array widthS[20].</li></ol></div></div></div><div class="section" title="&amp;output_control namelist"><div class="titlepage"><div><div><h3 class="title"><a id="id537992"></a>&amp;output_control namelist</h3></div></div></div>
		Parameters that control the output. For explanation of output files and their contents see below.  
		<div class="section" title="Determining times for output:"><div class="titlepage"><div><div><h4 class="title"><a id="id537998"></a>Determining times for output: </h4></div></div></div> 
			There are four different ways to control at which time step a specific out­put should be written. Outputs are generally distributed over the total cal­culation intervall unless an output time intervall is defined by a start time <span class="emphasis"><em>t_start</em></span> and a stop time <span class="emphasis"><em>t_stop</em></span>. If no <span class="emphasis"><em>t_start</em></span> is provided, the start time of the calculation is used. If no <span class="emphasis"><em>t_stop</em></span> is provided or <span class="emphasis"><em>t_stop&gt;t_start</em></span> the total calculation intervall is assumed 
			<div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">Prescribed number of outputs. The outputs are distributed evenly over the total calculation intervall so that the number of timesteps between two outputs is always the same, with the possible exception of the first intervall. Last output is written for the last time step, and to compen­sate the intervall before the first output may be longer. However, if t_stop is provided, the outputs are distributed evenly over the inter­vall [<span class="emphasis"><em>t_stop</em></span>,<span class="emphasis"><em>t_start</em></span>] with equal times intervalls between them. </li><li class="listitem">Defined intervall between two outputs, given in number of time steps. Again the last output is performed at the end of the run and a compen­sation may take place at the beginning. </li><li class="listitem">Defined time intervall between two outputs.</li><li class="listitem">Defined times for output. By default 2000 different times can be defi­ned for each output type. This can be increased by increasing <span class="emphasis"><em>n_time_hits</em></span> in the file <code class="filename">c_output.f</code>. </li></ol></div>
			While the first three possibilities can only be used alternatively, the fourth one can be employed in addition to one of the two others.
			<p>
				An important new parameter in this context is <span class="emphasis"><em>l_true_time</em></span>. If this is set to true, the time steps of the program are modified to meet a desired output time. This forces a recalculation of the inversion matricies and therefore re­quires some computing time. For <span class="emphasis"><em>l_true_time=.false.</em></span> the values at the timestep closest to the desired output time are chosen. Since the timesteps are generally small, this option suffices for most applications. 
			</p><p title="l_true_time=.true."><strong>l_true_time=.true. </strong>
				Logical, causes code to change time steps to meet output times. 
			</p><p title="n_graph_step"><strong>n_graph_step . </strong>
				Integer, intervall in no. of time steps for output of graphic files. 
			</p><p title="n_graphs"><strong>n_graphs . </strong>
				Integer, no. of graph files. 
			</p><p title="t_graph"><strong>t_graph . </strong>
				Real array of times for output. 99 times allo­wed by default. 
			</p><p title="dt_graph"><strong>dt_graph . </strong>
				Real, time intervall between outputs. 
			</p><p title="t_graph_start"><strong>t_graph_start . </strong>
				Real, time to start output. 
			</p><p title="t_graph_stop"><strong>t_graph_stop . </strong>
				Real, time to stop output. 
			</p><p title="n_rst_step"><strong>n_rst_step . </strong>
				Integer, intervall for storage of restart files. 
			</p><p title="n_rsts"><strong>n_rsts . </strong>
				Integer, no. of restart files. 
			</p><p title="t_rst"><strong>t_rst . </strong>
				Real array of times for restart files. 
			</p><p title="dt_rst"><strong>dt_rst . </strong>
				Real, time intervall between outputs. 
			</p><p title="t_rst_start"><strong>t_rst_start . </strong>
				Real, time to start output. 
			</p><p title="t_rst_stop"><strong>t_rst_stop . </strong>
				Real, time to stop output. 
			</p><p title="n_stores"><strong>n_stores . </strong>
				Integer, no. of storages of restart information. If <span class="emphasis"><em>n_stores &gt; n_rsts</em></span> a restart files is over­written. 
			</p><p title="n_log_step"><strong>n_log_step . </strong>
				Integer, intervall for writing energies, dipole information (dipole-file) and rotation informa­tion (rot-file). 
			</p><p title="n_logs"><strong>n_logs . </strong>
				Integer, no. of  log-information sets written. 
			</p><p title="t_log"><strong>t_log . </strong>
				Real array, times for log-information. 
			</p><p title="dt_log"><strong>dt_log . </strong>
				Real, time intervall between outputs. 
			</p><p title="t_log_start"><strong>t_log_start . </strong>
				Real, time to start output. 
			</p><p title="t_log_stop"><strong>t_log_stop . </strong>
				Real, time to stop output. 
			</p><p title="n_p_step"><strong>n_p_step . </strong>
				Integer, intervall for point-information (see below). 
			</p><p title="n_ps"><strong>n_ps . </strong>
				Integer, no. of point-informations written. 
			</p><p title="t_p"><strong>t_p . </strong>
				Real array, times for point information. 
			</p><p title="dt_p"><strong>dt_p . </strong>
				Real, time intervall between point-info. 
			</p><p title="t_p_start"><strong>t_p_start . </strong>
				Real, time to start output. 
			</p><p title="t_p_stop"><strong>t_p_stop . </strong>
				Real, time to stop output. 
			</p><p title="n_spec_step"><strong>n_spec_step . </strong>
				Integer, intervall for output of spectra.  
			</p><p title="n_specs"><strong>n_specs . </strong>
				Integer, no. of spectra files that will be plotted, evenly spaced in time, during the run. The spectra correspond to particular time steps (example: if <span class="emphasis"><em>n_specs</em></span> is 1, the output will be spectra of the last time step of the run). For time averages, set <span class="emphasis"><em>l_average</em></span> to <code class="filename">.TRUE.</code>.
			</p><p title="t_spec"><strong>t_spec . </strong>
				Real array, times for spectra.  
			</p><p title="dt_spec"><strong>dt_spec . </strong>
				Real, time intervall between outputs.  
			</p><p title="t_spec_start"><strong>t_spec_start . </strong>
				Real, time to start output.  
			</p><p title="t_spec_stop"><strong>t_spec_stop . </strong>
				Real, time to stop output. 
			</p><p title="n_diag_step"><strong>n_diag_step . </strong>
				Integer, intervall for diagnosis output.  
			</p><p title="n_diags"><strong>n_diags . </strong>
				Integer, no. of diagnosis outputs.  
			</p><p title="t_diag"><strong>t_diag . </strong>
				Real array, times for diagnosis.  
			</p><p title="dt_diag"><strong>dt_diag . </strong>
				Real, time intervall between outputs.  
			</p><p title="t_diag_start"><strong>t_diag_start . </strong>
				Real, time to start output.  
			</p><p title="t_diag_stop"><strong>t_diag_stop . </strong>
				Real, time to stop output. 
			</p><p title="n_cmb_step"><strong>n_cmb_step  . </strong>
				Integer, intervall for CMB field output. 
			</p><p title="n_cmbs"><strong>n_cmbs  . </strong>
				Integer, no. of CMB field outputs. 
			</p><p title="t_cmb"><strong>t_cmb  . </strong>
				Real array, times for CMB field output. 
			</p><p title="dt_cmb"><strong>dt_cmb  . </strong>
				Real, time intervall between CMB field out­puts. 
			</p><p title="t_cmb_start"><strong>t_cmb_start  . </strong>
				Real, time to start CMB field output. 
			</p><p title="t_cmb_stop"><strong>t_cmb_stop  . </strong>
				Real, time to stop CMB field output. 
			</p><p title="n_movie_step"><strong>n_movie_step . </strong>
				Integer, time steps between movie frames. 
			</p><p title="n_movie_frames"><strong>n_movie_frames . </strong>
				Integer, total no. of movie frames. 
			</p><p title="t_movie"><strong>t_movie . </strong>
				Real array, times for movie frames. 
			</p><p title="dt_movie"><strong>dt_movie . </strong>
				Real, time intervall between movie frames. 
			</p><p title="t_movie_start"><strong>t_movie_start. </strong>
				Real, time for first movie frame. 
			</p><p title="t_movie_stop"><strong>t_movie_stop. </strong>
				Real, time for last movie frame. 
			</p><p title="ngform"><strong>ngform. </strong>
				Integer, format for graphic files. 
				</p><div class="variablelist"><dl><dt><span class="term">ngform=-1 </span></dt><dd>Formatted output with comments. </dd><dt><span class="term">ngform=0 	</span></dt><dd>Unformatted output. </dd><dt><span class="term">ngform=1 	</span></dt><dd>Formatted output, no comments. </dd></dl></div><p title="ngform">
				The output grid for the graphic output can be chosen differently from the grid the calculations are performed on, but the former is always a subgrid of the latter. 
			</p><p title="ns_r_gra"><strong>ns_r_gra . </strong>
				Integer, output of each <span class="emphasis"><em>ns_r_gra</em></span> radial grid point from the numerical grid in graphic file. 
			</p><p title="ns_theta_gra"><strong>ns_theta_gra . </strong>
				Integer, output of each <span class="emphasis"><em>ns_theta_gra</em></span> colatitude grid point in graphic file.  
			</p><p title="ns_phi_gra"><strong>ns_phi_gra. </strong>
				Integer, output of each <span class="emphasis"><em>ns_phi_gra</em></span> longitude grid point ... 
			</p><p title="ns_r_ic_gra"><strong>ns_r_ic_gra . </strong>
				Integer, output of each ns_r_ic_gra radial grid point in the IC ...  
			</p><p title="runid"><strong>runid . </strong>
				Character string printed in graphic output files. Can be printed by plotting routines. 
			</p></div><div class="section" title="Filtering of CMB Field:"><div class="titlepage"><div><div><h4 class="title"><a id="id538544"></a>Filtering of CMB Field: </h4></div></div></div>
	                  To compare the results with the CMB field of geomagnetic inversions, the CMB field of the graphics output can be filtered. Two filters <span class="emphasis"><em>w(l)</em></span> are offe­red, where <span class="emphasis"><em>w</em></span> is the weight and <span class="emphasis"><em>l</em></span> the harmonic degree: 
			<div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">For <span class="emphasis"><em>alfilt&gt;0</em></span> Super-Gaussian filter: 
					<div class="informalequation"><span class="mathphrase">W(l) = e<sup>-(l/alfilt)<sup>nfilt</sup></sup></span></div></li><li class="listitem">For <span class="emphasis"><em>alfilt&lt;0</em></span> Cos-taper filter:
					<div class="informalequation"><span class="mathphrase">W(l) = {-sin[π((l-nfilt)/|alfilt|)]}/2</span></div></li></ol></div><p title="nfilt"><strong>nfilt. </strong>
				Integer, see above for definition. 
			</p><p title="ivfilt"><strong>ivfilt . </strong>
				Integer, no. of radial level where the filtering is perfor­med. Use <span class="emphasis"><em>ivfilt=1</em></span> for CMB. No filtering is performed for <span class="emphasis"><em>ivfilt&lt;1</em></span>. 
			</p><p title="alfilt"><strong>alfilt . </strong>
				Real, see above for definition. 
				</p><div class="variablelist"><dl><dt><span class="term">alfilt&gt;0 </span></dt><dd>Use super-Gaussian filter</dd><dt><span class="term">alfilt&lt;0 </span></dt><dd>Use cos-taper filter. </dd></dl></div><p title="dipfilt"><strong>dipfilt . </strong>
				Real, additional factor applied to dipole (l=1,m=0). 
			</p></div><div class="section" title="Movies:"><div class="titlepage"><div><div><h4 class="title"><a id="id538664"></a>Movies: </h4></div></div></div>
			Parameters that determine the number and times of movie frames have al­ready been explained above. Movie-files are only written if
			<p title="l_movie=.true."><strong>l_movie=.true. . </strong>
				Logical, envokes production of movie files. 
			</p>
			Generally several movie-files can be produced during a run [limited to 10 by <span class="emphasis"><em>n_movies_max</em></span> in <code class="filename">c_output.f</code>]. The movies are defined by a key­word detemining the fields to be plotted and an expression that determins the movie surface. The code searches this information in a character string provided for each movie. These strings are elements of the array <span class="command"><strong><span class="emphasis"><em>movie.</em></span></strong></span>. For example, to invoke a movie(file) that shows (stores) the radial magne­tic field at the CMB, you have to provide the line 
			<p>
				<code class="filename">movie(1)= Br CMB </code>
			</p><p>
	                            in the output namelist. Here, Br is the keyword for the radial magnetic field and CMB the expression that defines the movie surface. If, in addition, a movie of the temperature field at the meridional slice <span class="emphasis"><em>phi=0</em></span> is desired, the following line has to be added: 
			</p><p>
				<code class="filename">movie(2)= T phi=0</code>
			</p><p>
				Note that the code does not interpret blanks and ignores additional charac­ters that do not form a keyword or a surface definition. Thus, for example <span class="emphasis"><em>Br</em></span> or <span class="emphasis"><em>Br</em></span> or <span class="emphasis"><em>Bradial</em></span> are all interpreted as the same keyword. Furthermo­re, the interpretation is not case-sensitive. Another example: the keywords <span class="emphasis"><em>Toroidal axisymmetric field</em></span> and <span class="emphasis"><em>toraxi</em></span> cause the same movie file to be written. Note that the keywords <span class="emphasis"><em>fieldlines</em></span> and <span class="emphasis"><em>toraxi</em></span> do not need an expression defining the surface. 
			</p><div class="informaltable"><table border="1"><colgroup><col align="left" class="col1" /><col align="left" class="col2" /></colgroup><thead><tr><th align="center">Keyword</th><th align="left">Fields stored in movie file</th></tr></thead><tbody><tr><td align="left"><code class="filename">B r[radial]</code></td><td align="left">Radial magnetic field</td></tr><tr><td align="left"><code class="filename">B t[heta]</code></td><td align="left">Theta component of the magnetic field</td></tr><tr><td align="left"><code class="filename">B p[hi]</code></td><td align="left">Azimuthal magnetic field component.</td></tr><tr><td align="left"><code class="filename">B h[orizontal]</code></td><td align="left">The two horizontal components of the magnetic field.</td></tr><tr><td align="left"><code class="filename">B a[ll]</code></td><td align="left">All magnetic field components</td></tr><tr><td align="left"><code class="filename">Fieldline[s]</code> or <code class="filename">FL</code></td><td align="left">Axisymmetric poloidal field lines in a meridio­nal cut.</td></tr><tr><td align="left"><code class="filename">AX[ISYMMETRIC] B</code> or <code class="filename">AB</code></td><td align="left">Axisymmetric phi component of the magnetic field for phi=constant.</td></tr><tr><td align="left"><code class="filename">V r[adial]</code></td><td align="left">Radial velocity field.</td></tr><tr><td align="left"><code class="filename">V t[heta]</code></td><td align="left">Theta component of the velocity field.</td></tr><tr><td align="left"><code class="filename">V p[hi]</code></td><td align="left">Azimuthal velocity field.</td></tr><tr><td align="left"><code class="filename">V h[orizontal]</code></td><td align="left">Horizontal velocity field, two components depending on the surface.</td></tr><tr><td align="left"><code class="filename">V a[ll]</code></td><td align="left">All velocity field components.</td></tr><tr><td align="left"><code class="filename">Streamline[s]</code> or <code class="filename">SL</code></td><td align="left">Field lines of axisymmetric poloidal field for phi=constant.</td></tr><tr><td align="left"><code class="filename">AX[ISYMMETRIC] V</code> or <code class="filename">AV</code></td><td align="left">Axisymmetric phi component of the velocity field for phi=constant.</td></tr><tr><td align="left"><code class="filename">V z</code></td><td align="left">Z component of velocity at equator + z component of the vorticity at the equator (closest point to equator).</td></tr><tr><td align="left"><code class="filename">Vo z</code></td><td align="left">Z-component of vorticity.</td></tr><tr><td align="left"><code class="filename">Vo r</code></td><td align="left">R-component of vorticity.</td></tr><tr><td align="left"><code class="filename">Vo p</code></td><td align="left">Phi-component of vorticity.</td></tr><tr><td align="left"><code class="filename">T[emperature]</code></td><td align="left">sic</td></tr><tr><td align="left"><code class="filename">AX[ISYMMETRIC] T</code> or <code class="filename">AT</code></td><td align="left">Axisymmetric T field for phi=constant.</td></tr><tr><td align="left"><code class="filename">Heat t[ransport]</code></td><td align="left">Radial derivative of T.</td></tr><tr><td align="left"><code class="filename">FL Pro</code></td><td align="left">Axisymmetric field line stretching.</td></tr><tr><td align="left"><code class="filename">FL Adv</code></td><td align="left">Axisymmetric field line advection.</td></tr><tr><td align="left"><code class="filename">FL Dif</code></td><td align="left">Axisymmetric field line diffusion.</td></tr><tr><td align="left"><code class="filename">AB Pro</code></td><td align="left">Axisymmetric (tor.) Bphi production.</td></tr><tr><td align="left"><code class="filename">AB Dif</code></td><td align="left">Axisymmetric (tor.) Bphi diffusion.</td></tr><tr><td align="left"><code class="filename">Br Pro</code></td><td align="left">Br production.</td></tr><tr><td align="left"><code class="filename">Br Adv</code></td><td align="left">Br advection.</td></tr><tr><td align="left"><code class="filename">Br Dif</code></td><td align="left">Br diffusion.</td></tr><tr><td align="left"><code class="filename">Jr</code></td><td align="left">Jr production.</td></tr><tr><td align="left"><code class="filename">Jr Pro</code></td><td align="left">Jr production +  omega effects.</td></tr><tr><td align="left"><code class="filename">Jr Adv</code></td><td align="left">Jr advection.</td></tr><tr><td align="left"><code class="filename">Jr Dif</code></td><td align="left">Jr diffusion.</td></tr><tr><td align="left"><code class="filename">Bz Pol</code></td><td align="left">Poloidal Bz.</td></tr><tr><td align="left"><code class="filename">Bz Pol Pro</code></td><td align="left">Poloidal Bz production.</td></tr><tr><td align="left"><code class="filename">Bz Pol Adv</code></td><td align="left">Poloidal Bz advection.</td></tr><tr><td align="left"><code class="filename">Bz Pol Dif</code></td><td align="left">Poloidal Bz diffusion.</td></tr><tr><td align="left"><code class="filename">Jz Tor</code></td><td align="left">Toroidal Jz. </td></tr><tr><td align="left"><code class="filename">Jz Tor Pro</code></td><td align="left">Toroidal Jz production. </td></tr><tr><td align="left"><code class="filename">Jz Tor Adv</code></td><td align="left">Toroidal Jz advection.</td></tr><tr><td align="left"><code class="filename">Jz Tor Dif</code></td><td align="left">Toroidal Jz diffusion.</td></tr><tr><td align="left"><code class="filename">Bp Tor</code></td><td align="left">Toroidal Bphi.</td></tr><tr><td align="left"><code class="filename">Bp Tor Pro</code></td><td align="left">Toroidal Bphi production.</td></tr><tr><td align="left"><code class="filename">Bp Tor Adv</code></td><td align="left">Toroidal Bphi advection.</td></tr><tr><td align="left"><code class="filename">Bp Tor Dif</code></td><td align="left">Toroidal Bphi diffusion.</td></tr><tr><td align="left"><code class="filename">HEL[ICITY]</code></td><td align="left">sic</td></tr><tr><td align="left"><code class="filename">AX[ISYMMETRIC HELICITY]</code> or <code class="filename">AHEL</code></td><td align="left">Axisymmetric helicity.</td></tr><tr><td align="left"><code class="filename">Bt Tor</code></td><td align="left">Toroidal Btheta.</td></tr><tr><td align="left"><code class="filename">Pot Tor</code></td><td align="left">Toroidal potential.</td></tr><tr><td align="left"><code class="filename">Pol Fieldlines</code></td><td align="left">Poloidal fieldlines.</td></tr><tr><td align="left"><code class="filename">Br Shear</code></td><td align="left">Azimuthal Shear of Br.</td></tr><tr><td align="left"><code class="filename">Lorentz[force]</code></td><td align="left">Lorentz force (only phi component).</td></tr><tr><td align="left"><code class="filename">Br Inv</code></td><td align="left">Inverse field apperance at CMB.</td></tr></tbody></table></div><div class="informaltable"><table border="1"><colgroup><col align="left" class="col1" /><col align="left" class="col2" /></colgroup><thead><tr><th align="center">Surface expression</th><th align="left">Surface</th></tr></thead><tbody><tr><td align="left"><code class="filename">CMB</code></td><td align="left">Core-mantle boundary</td></tr><tr><td align="left"><code class="filename">Surface</code></td><td align="left">Earth surface</td></tr><tr><td align="left"><code class="filename">r</code>=<span class="emphasis"><em>radius</em></span></td><td align="left">Radial surface at r=radius  with radius given in units of the outer core radius.</td></tr><tr><td align="left"><code class="filename">theta</code>=<span class="emphasis"><em>colatitude</em></span></td><td align="left">Cut at constant colatitude given in degree</td></tr><tr><td align="left"><code class="filename">phi</code>=<span class="emphasis"><em>phi</em></span></td><td align="left">Slice at constant longitude given in degree.</td></tr></tbody></table></div><p>
				Similar to the graphic output grid, the movie grid is a subgrid of the num­verical grid. A different grid can be chosen for movies at the Earth surface where the magnetic field in of larger scale than in the core. 
			</p><p title="ns_r_mov"><strong>ns_r_mov. </strong>
				Integer, output of each ns_r_mov radial grid point from the numerical grid in movie file.  
			</p><p title="ns_theta_mov"><strong>ns_theta_mov. </strong>
				Integer, output of each ns_theta_mov colatitude grid point in movie file.  
			</p><p title="ns_phi_mov"><strong>ns_phi_mov. </strong>
				Integer, output of each ns_phi_mov longitude grid point ...   
			</p><p title="ns_r_ic_mov"><strong>ns_r_ic_mov. </strong>
				Integer, output of each ns_r_ic_mov radial grid point in the IC ...   
			</p><p title="ns_theta_sur"><strong>ns_theta_sur. </strong>
				Integer, output of each ns_theta_mov colatitude grid point in movie file at Earth surface.   
			</p><p title="ns_phi_sur"><strong>ns_phi_sur. </strong>
				Integer, output of each ns_phi_mov longitude grid point in movie file for Earth surface.  
			</p></div><div class="section" title="Magnetic field at the CMB:"><div class="titlepage"><div><div><h4 class="title"><a id="id540236"></a>Magnetic field at the CMB: </h4></div></div></div>
			The poloidal field coeffitients are stored in a special file at the times de­fined by one of the parameters mentioned next (<code class="filename">n_cmbs</code> or <code class="filename">n_cmb_step</code>), if:  
	                 <p title="l_cmb_field=.true."><strong>l_cmb_field=.true.  . </strong>
				   Logical, envokes output of field at CMB.  
			</p><p title="n_cmbs"><strong>n_cmbs. </strong>
				   Number of time steps recorded in the file during the run.
			</p><p title="n_cmb_step"><strong>n_cmb_step. </strong>
				   Number of steps between consecutive recordings in the file during the run. 
			</p></div><div class="section" title="RMS balance:"><div class="titlepage"><div><div><h4 class="title"><a id="id540274"></a>RMS balance:</h4></div></div></div>
			The RMS values are determined and written in specific output files if:
	                 <p title="l_RMS=.true."><strong>l_RMS=.true.  . </strong>
				   Logical, envokes calculation of RMS outputs.  
			</p></div><div class="section" title="Field Averages:"><div class="titlepage"><div><div><h4 class="title"><a id="id540290"></a>Field Averages: </h4></div></div></div>
			The code can performe on-the-fly time averaging of entropy, velocity field and magnetic field. Respective graphics output and spectra are written into the files numbered 0 (see below). Averaged energies are written into the log-file. 
			<p title="l_average=.true."><strong>l_average=.true. . </strong>
				Logical, envokes averaging of fields.  
			</p></div><div class="section" title="Secure Output:"><div class="titlepage"><div><div><h4 class="title"><a id="id540304"></a>Secure Output: </h4></div></div></div>
			Secure output can be chosen be setting  
			<p title="l_save_out=.true."><strong>l_save_out=.true. </strong>
				Logical, envokes secure output.
			</p>
			The program closes each output file after a write command, and reopens it if necessary. This may cost some computing time, but guarantees that only minimal information is lost in case of a crash.   
		</div></div><div class="section" title="&amp;mantle namelist"><div class="titlepage"><div><div><h3 class="title"><a id="id540320"></a>&amp;mantle namelist  </h3></div></div></div>
		Defines mantle properties:
		<p title="conductance_ma"><strong>conductance_ma . </strong>
			Real, conductance of a thin layer at the CMB, dimensionless.  
		</p><p title="nRotMa"><strong>nRotMa  . </strong>
			Integer determining mantle rotation 
			</p><div class="variablelist"><dl><dt><span class="term">nRotMa=1  </span></dt><dd>Rotating mantle according to torques  </dd><dt><span class="term">nRotMa=0  </span></dt><dd>Fixed, non-rotating mantle  </dd><dt><span class="term">nRotMa=-1  </span></dt><dd>Mantle rotates with prescribed rate <span class="emphasis"><em>omega_ma1</em></span></dd></dl></div><p title="omega_ma1"><strong>omega_ma1. </strong>
			Real, a prescribed initial mantle rotation rate. 
		</p><p title="rho_ratio_ma"><strong>rho_ratio_ma. </strong>
			Real, (mean) mantle density in units of outer core density.  
		</p></div><div class="section" title="&amp;inner_core namelist"><div class="titlepage"><div><div><h3 class="title"><a id="id540395"></a>&amp;inner_core namelist  </h3></div></div></div>
		Defines inner core properties: 
		<p title="sigma_ic"><strong>sigma_ic . </strong>
			Real, ratio of inner core and outer core conduc­tivities. 
		</p><p title="nRotIc"><strong>nRotIc  . </strong>
			Integer, determines IC rotation, see nRotMa.
		</p><p title="omega_ic1"><strong>omega_ic1 	. </strong>
			Real, a prescribed inner core rotation rate.
		</p><p title="rho_ratio_ic"><strong>rho_ratio_ic . </strong>
			Real, (mean) inner core density in units of outer core density. 
		</p></div></div></div><div class="chapter" title="Chapter 3. Output"><div class="titlepage"><div><div><h2 class="title"><a id="chap3"></a>Chapter 3. Output</h2></div></div></div><p>
	While some information of a run is written into STDOUT to monitor its progress, most output is printed into files identified by the extension .tag. Some information found in STDOUT is also written to the log-file called log.tag. In addition, this file contains all input parameters, truncation, in­formation on other output files, and some results like the time averaged en­ergies (for l_average=.true.). Routines that process the results extract information concerning the run from log.tag and keywords are used in to identify the different contents. Other output files, are organised in columns or lines (datasets). Thier meaning is explained below. The number of graphic files (G# .tag or g#.tag), restart files (rst#.tag), and spectrum files (spec# .tag) are determined by the input parameters in the namelist &amp;output.contrl (see above). A new file is produced for each output time. If time averaging has been chosen the time averaged gra­phic and spectrum files will have the no. 0. All other files are numbered consecutively starting with 1. Times at which these files have been written can be found in log.tag.Other files (except the log-file) contain time sequences. The times for the sequences in the energy files, the rot-file, the dipole-file, and the misc-file are determined by the log-times (see above). Output times for cmb-file and movie frames are chosen independently (see above). Restart, movie and cmb-file (B_coeff _cmb.tag) are unformatted files (organised in datasets, called lines here). 
</p><p title="log.tag"><strong>log.tag . </strong>
	Contents in order of appearence: 
	</p><div class="informaltable"><table border="1"><colgroup><col align="left" class="col1" /><col align="left" class="col2" /></colgroup><tbody><tr><td align="left">1</td><td align="left">Program version</td></tr><tr><td align="left">2</td><td align="left">Mode (dynamo,convection,...) </td></tr><tr><td align="left">3</td><td align="left">Grid parameter</td></tr><tr><td align="left">4</td><td align="left">Name-lists</td></tr><tr><td align="left">5</td><td align="left">Start-field and start time</td></tr><tr><td align="left">6</td><td align="left">Information on time stepping progress in step of 10%</td></tr><tr><td align="left">7</td><td align="left">Name and time of graphic files.</td></tr><tr><td align="left">8</td><td align="left">Name and time of restart files.</td></tr><tr><td align="left">9</td><td align="left">Time averaged energies for l_average=.true.</td></tr><tr><td align="left">10</td><td align="left">Energies at end of run.</td></tr><tr><td align="left">11</td><td align="left">End time.</td></tr></tbody></table></div><p title="e_mag_ic.tag"><strong>e_mag_ic.tag . </strong>
	Inner core magnetic energy. This file is writ­ten by <code class="filename">s_get_e_kin.f</code>.
	</p><div class="informaltable"><table border="1"><colgroup><col align="left" class="col1" /><col align="left" class="col2" /></colgroup><thead><tr><th align="center">No. of column</th><th align="center">Contents</th></tr></thead><tbody><tr><td align="left">1</td><td align="left">time</td></tr><tr><td align="left">2</td><td align="left">IC poloidal energy</td></tr><tr><td align="left">3</td><td align="left">IC toroidal energy</td></tr><tr><td align="left">4</td><td align="left">IC axisymmetric poloidal energy</td></tr><tr><td align="left">5</td><td align="left">IC axisymmetric toroidal energy</td></tr></tbody></table></div><p title="anel.tag"><strong>anel.tag. </strong>
	Profile of background density (only available when <code class="filename">strat</code> is higher than zero).
	</p><div class="informaltable"><table border="1"><colgroup><col align="left" class="col1" /><col align="left" class="col2" /></colgroup><thead><tr><th align="center">No. of column</th><th align="center">Contents</th></tr></thead><tbody><tr><td align="left">1</td><td align="left">Radius</td></tr><tr><td align="left">2</td><td align="left">Temperature profile</td></tr><tr><td align="left">3</td><td align="left">Density profile <span class="mathphrase">ρ</span></td></tr><tr><td align="left">4</td><td align="left">Beta profile (<span class="mathphrase">β=dlnρ/dr</span>)</td></tr><tr><td align="left">5</td><td align="left">dBeta profile (<span class="mathphrase">dβ=dβ/dr</span>)</td></tr><tr><td align="left">6</td><td align="left">Gravity profile</td></tr></tbody></table></div><p title="rNM.tag"><strong>rNM.tag. </strong>
	Profile of the nonlinear mapping.
	</p><div class="informaltable"><table border="1"><colgroup><col align="left" class="col1" /><col align="left" class="col2" /></colgroup><thead><tr><th align="center">No. of column</th><th align="center">Contents</th></tr></thead><tbody><tr><td align="left">1</td><td align="left">Grid point index</td></tr><tr><td align="left">2</td><td align="left">Radius of a grid point</td></tr><tr><td align="left">3</td><td align="left">First derivative of the mapping at a grid point</td></tr><tr><td align="left">4</td><td align="left">Second derivative of the mapping at a grid point</td></tr><tr><td align="left">5</td><td align="left">Third derivative of the mapping at a grid point</td></tr></tbody></table></div><p title="varCond.tag"><strong>varCond.tag. </strong>
	Profile of the variable conductivity.
	</p><div class="informaltable"><table border="1"><colgroup><col align="left" class="col1" /><col align="left" class="col2" /></colgroup><thead><tr><th align="center">No. of column</th><th align="center">Contents</th></tr></thead><tbody><tr><td align="left">1</td><td align="left">Radius</td></tr><tr><td align="left">2</td><td align="left">Conductivity <span class="mathphrase">σ</span></td></tr><tr><td align="left">3</td><td align="left">Inverse of the conductivity <span class="mathphrase">λ</span></td></tr><tr><td align="left">4</td><td align="left">Derivative of the inverse of the conductivity <span class="mathphrase">dλ</span></td></tr></tbody></table></div><p title="e_mag_oc.tag"><strong>e_mag_oc.tag. </strong>
	Outer core magnetic energy and energy ouside the core. This file is writ­ten by <code class="filename">s_get_e_mag.f</code>.
	</p><div class="informaltable"><table border="1"><colgroup><col align="left" class="col1" /><col align="left" class="col2" /></colgroup><thead><tr><th align="center">No. of column</th><th align="center">Contents</th></tr></thead><tbody><tr><td align="left">1</td><td align="left">time</td></tr><tr><td align="left">2</td><td align="left">OC poloidal energy</td></tr><tr><td align="left">3</td><td align="left">OC toroidal energy </td></tr><tr><td align="left">4</td><td align="left">OC axisymmetric poloidal energy </td></tr><tr><td align="left">5</td><td align="left">OC axisymmetric toroidal energy </td></tr><tr><td align="left">6</td><td align="left">outside (poloidal) energy </td></tr><tr><td align="left">7</td><td align="left">outside axisymmetric (poloidal) energy </td></tr><tr><td align="left">8</td><td align="left">equatorial symmetric poloidal energy</td></tr><tr><td align="left">9</td><td align="left">equatorial symmetric toroidal energy</td></tr><tr><td align="left">10</td><td align="left">equatorial axisymmetric poloidal energy</td></tr><tr><td align="left">11</td><td align="left">equatorial axisymmetric toroidal energy</td></tr><tr><td align="left">12</td><td align="left">outside potential field energy</td></tr><tr><td align="left">13</td><td align="left">outside potential field axisymmetric energy</td></tr></tbody></table></div><p title="eMagR.tag"><strong>eMagR.tag. </strong>
	Outer core magnetic energy and energy ouside the core along the radius, averaged in time. This file is writ­ten by <code class="filename">s_get_e_mag.f</code>.
	</p><div class="informaltable"><table border="1"><colgroup><col align="left" class="col1" /><col align="left" class="col2" /></colgroup><thead><tr><th align="center">No. of column</th><th align="center">Contents</th></tr></thead><tbody><tr><td align="left">1</td><td align="left">radial level</td></tr><tr><td align="left">2</td><td align="left">time-averaged poloidal energy</td></tr><tr><td align="left">3</td><td align="left">time-averaged axisymmetric poloidal energy</td></tr><tr><td align="left">4</td><td align="left">time-averaged toroidal energy</td></tr><tr><td align="left">5</td><td align="left">time-averaged axisymmetric toroidal energy</td></tr><tr><td align="left">6</td><td align="left">time-averaged poloidal energy, normalized by surface area at this radial level</td></tr><tr><td align="left">7</td><td align="left">time-averaged axisymmetric poloidal energy, normalized by surface area at this radial level</td></tr><tr><td align="left">8</td><td align="left">time-averaged toroidal energy, normalized by surface area at this radial level</td></tr><tr><td align="left">9</td><td align="left">time-averaged axisymmetric toroidal energy, normalized by surface area at this radial level</td></tr><tr><td align="left">10</td><td align="left">ratio between time-averaged dipole energy and time-averaged total energy</td></tr></tbody></table></div><p title="e_kin.tag"><strong>e_kin.tag . </strong>
	Outer core kinetic energy. This file is writ­ten by <code class="filename">s_get_e_kin.f</code>.
	</p><div class="informaltable"><table border="1"><colgroup><col align="left" class="col1" /><col align="left" class="col2" /></colgroup><thead><tr><th align="center">No. of column</th><th align="center">Contents </th></tr></thead><tbody><tr><td align="left">1</td><td align="left">time</td></tr><tr><td align="left">2</td><td align="left">poloidal energy </td></tr><tr><td align="left">3</td><td align="left">toroidal energy </td></tr><tr><td align="left">4</td><td align="left">axisymmetric poloidal energy</td></tr><tr><td align="left">5</td><td align="left">axisymmetric toroidal energy </td></tr><tr><td align="left">6</td><td align="left">equatorial symmetric poloidal energy</td></tr><tr><td align="left">7</td><td align="left">equatorial symmetric toroidal energy </td></tr><tr><td align="left">8</td><td align="left">equatorial axisymmetric poloidal energy</td></tr><tr><td align="left">9</td><td align="left">equatorial axisymmetric toroidal energy </td></tr></tbody></table></div><p title="eKinR.tag"><strong>eKinR.tag. </strong>
	Outer core kinetic energy and energy ouside the core along the radius, averaged in time. This file is writ­ten by <code class="filename">s_get_e_kin.f</code>.
	</p><div class="informaltable"><table border="1"><colgroup><col align="left" class="col1" /><col align="left" class="col2" /></colgroup><thead><tr><th align="center">No. of column</th><th align="center">Contents</th></tr></thead><tbody><tr><td align="left">1</td><td align="left">radial level</td></tr><tr><td align="left">2</td><td align="left">time-averaged poloidal energy</td></tr><tr><td align="left">3</td><td align="left">time-averaged axisymmetric poloidal energy</td></tr><tr><td align="left">4</td><td align="left">time-averaged toroidal energy</td></tr><tr><td align="left">5</td><td align="left">time-averaged axisymmetric toroidal energy</td></tr><tr><td align="left">6</td><td align="left">time-averaged poloidal energy, normalized by surface area at this radial level</td></tr><tr><td align="left">7</td><td align="left">time-averaged axisymmetric poloidal energy, normalized by surface area at this radial level</td></tr><tr><td align="left">8</td><td align="left">time-averaged toroidal energy, normalized by surface area at this radial level</td></tr><tr><td align="left">9</td><td align="left">time-averaged axisymmetric toroidal energy, normalized by surface area at this radial level</td></tr></tbody></table></div><p title="u_square.tag"><strong>u_square.tag . </strong>
	Square velocity calculated as <span class="mathphrase">(1/2) ∫v<sup>2</sup>dv</span>. This file is writ­ten by <code class="filename">s_get_u_square.f</code>.
	</p><div class="informaltable"><table border="1"><colgroup><col align="left" class="col1" /><col align="left" class="col2" /></colgroup><thead><tr><th align="center">No. of column</th><th align="center">Contents </th></tr></thead><tbody><tr><td align="left">1</td><td align="left">time</td></tr><tr><td align="left">2</td><td align="left">poloidal energy </td></tr><tr><td align="left">3</td><td align="left">toroidal energy </td></tr><tr><td align="left">4</td><td align="left">axisymmetric poloidal energy</td></tr><tr><td align="left">5</td><td align="left">axisymmetric toroidal energy </td></tr><tr><td align="left">6</td><td align="left">Rossby number</td></tr><tr><td align="left">7</td><td align="left">magnetic Reynolds number</td></tr><tr><td align="left">8</td><td align="left">local Rossby number</td></tr><tr><td align="left">9</td><td align="left">velocity length scale</td></tr><tr><td align="left">10</td><td align="left">non-axisymmetric local Rossby number</td></tr><tr><td align="left">11</td><td align="left">non-axisymmetric velocity length scale</td></tr></tbody></table></div><p title="dipole.tag"><strong>dipole.tag . </strong>
	Information about the magnetic dipole.
	</p><div class="informaltable"><table border="1"><colgroup><col align="left" class="col1" /><col align="left" class="col2" /></colgroup><thead><tr><th align="center">No. of column </th><th align="center">Contents </th></tr></thead><tbody><tr><td align="left">1</td><td align="left">time </td></tr><tr><td align="left">2</td><td align="left">colatitude of dipole-pole</td></tr><tr><td align="left">3</td><td align="left">longitude of dipole-pole </td></tr><tr><td align="left">4</td><td align="left">relative energy of axisymmetric dipole</td></tr><tr><td align="left">5</td><td align="left">relative energy of axisymmetric dipole at the CMB</td></tr><tr><td align="left">6</td><td align="left">energy of axisymmetric dipole at the CMB, normalized with total energy up to degree and order 11 	(?) </td></tr><tr><td align="left">7</td><td align="left">relative energy of dipole</td></tr><tr><td align="left">8</td><td align="left">relative energy of dipole in the outer core</td></tr><tr><td align="left">9</td><td align="left">relative energy of dipole at the CMB</td></tr><tr><td align="left">10</td><td align="left">energy of dipole at the CMB</td></tr><tr><td align="left">11</td><td align="left">axisymmetric energy of dipole at the CMB</td></tr><tr><td align="left">12</td><td align="left">energy of dipole</td></tr><tr><td align="left">13</td><td align="left">axisymmetric energy of dipole</td></tr><tr><td align="left">14</td><td align="left">energy at the CMB</td></tr><tr><td align="left">15</td><td align="left">total energy up to degree and order 11 (?)</td></tr><tr><td align="left">16</td><td align="left">ratio between equatorial dipole energy and equatorial poloidal energy</td></tr><tr><td align="left">17</td><td align="left">difference between energy at the CMB and equatorial symmetric energy at the CMB, normalized by energy at the CMB</td></tr><tr><td align="left">18</td><td align="left">difference between energy at the CMB and axisymmetric energy at the CMB, normalized by energy at the CMB</td></tr><tr><td align="left">19</td><td align="left">difference between total energy and equatorial symmetric part of the total energy, normalized by the total energy</td></tr><tr><td align="left">20</td><td align="left">difference between total energy and axisymmetric part of the total energy, normalized by the total energy</td></tr></tbody></table></div><p title="AM.tag"><strong>AM.tag. </strong>
	Output concerning the angular momentum. This file is writ­ten by <code class="filename">s_write_rot.f</code>.
	</p><div class="informaltable"><table border="1"><colgroup><col align="left" class="col1" /><col align="left" class="col2" /></colgroup><thead><tr><th align="center">No. of column </th><th align="center">Contents </th></tr></thead><tbody><tr><td align="left">1 </td><td align="left">time </td></tr><tr><td align="left">2 </td><td align="left">OC angular momentum</td></tr><tr><td align="left">3 </td><td align="left">IC angular momentum </td></tr><tr><td align="left">4 </td><td align="left">mantle angular momentum</td></tr><tr><td align="left">5 </td><td align="left">total angular momentum</td></tr><tr><td align="left">6 </td><td align="left">relative change in angular momentum, per time step</td></tr><tr><td align="left">7 </td><td align="left">total kinetic angular momentum</td></tr><tr><td align="left">8 </td><td align="left">relative change in kinetic energy, per time step</td></tr><tr><td align="left">9 </td><td align="left">kinetic energy at the inner core</td></tr><tr><td align="left">10 </td><td align="left">kinetic energy at the outer core</td></tr><tr><td align="left">11 </td><td align="left">kinetic energy at the mantle</td></tr></tbody></table></div><p title="misc.tag"><strong>misc.tag. </strong>
	This file constains time sequences of the Nusselt number at the inner and outer boundary. The name has been chose because more output might be written into this file in later version.. 
	</p><div class="informaltable"><table border="1"><colgroup><col align="left" class="col1" /><col align="left" class="col2" /></colgroup><thead><tr><th align="center">No. of column </th><th align="center">Contents </th></tr></thead><tbody><tr><td align="left">1 </td><td align="left">time </td></tr><tr><td align="left">2 </td><td align="left">Nusselt number at the inner-core boundary </td></tr><tr><td align="left">3 </td><td align="left">Nusselt number at the core-mantle boundary</td></tr><tr><td align="left">4 </td><td align="left">Entropy at the inner-core boundary</td></tr><tr><td align="left">5 </td><td align="left">Entropy at the core-mantle boundary</td></tr><tr><td align="left">6 </td><td align="left">Helicity on the Northern hemisphere</td></tr><tr><td align="left">7 </td><td align="left">Helicity on the Southern hemisphere</td></tr><tr><td align="left">8 </td><td align="left">Equatorial axisymmetric helicity</td></tr><tr><td align="left">9 </td><td align="left">RMS helicity</td></tr><tr><td align="left">10 </td><td align="left">Relative geostrophic kinetic energy</td></tr><tr><td align="left">11 </td><td align="left">Relative kinetic energy in the northern hemisphere of the TC (tangent cylinder)</td></tr><tr><td align="left">12 </td><td align="left">Relative kinetic energy in the sourthern hemisphere of the TC (tangent cylinder)</td></tr><tr><td align="left">13 </td><td align="left">Kinetic energy</td></tr><tr><td align="left">14 </td><td align="left">Vz North/South correlation, outside the TC (tangent cylinder)</td></tr><tr><td align="left">15 </td><td align="left">Vorticity North/South correlation, outside the TC (tangent cylinder)</td></tr><tr><td align="left">16 </td><td align="left">Helicity North/South correlation, outside the TC (tangent cylinder)</td></tr><tr><td align="left">17 </td><td align="left">Heat flux at the inner-core boundary</td></tr><tr><td align="left">18 </td><td align="left">Heat flux at the core-mantle boundary</td></tr></tbody></table></div><p title="mag_spec#.tag"><strong>mag_spec#.tag. </strong>
	Magnetic energy spectra.
	</p><div class="informaltable"><table border="1"><colgroup><col align="left" class="col1" /><col align="left" class="col2" /></colgroup><thead><tr><th align="center">No. of column </th><th align="center">Contents </th></tr></thead><tbody><tr><td align="left">1 </td><td align="left">degree / order </td></tr><tr><td align="left">2 </td><td align="left">OC poloidal magnetic energy per degree </td></tr><tr><td align="left">3 </td><td align="left">OC poloidal magnetic energy per order </td></tr><tr><td align="left">4 </td><td align="left">OC toroidal magnetic energy per degree </td></tr><tr><td align="left">5 </td><td align="left">OC toroidal magnetic energy per oder </td></tr><tr><td align="left">6 </td><td align="left">IC poloidal magnetic energy per degree </td></tr><tr><td align="left">7 </td><td align="left">IC poloidal magnetic energy per order </td></tr><tr><td align="left">8 </td><td align="left">IC toroidal magnetic energy per degree </td></tr><tr><td align="left">9 </td><td align="left">IC toroidal magnetic energy per order </td></tr><tr><td align="left">10 </td><td align="left">CMB (poloidal) magnetic energy per degree </td></tr><tr><td align="left">11 </td><td align="left">CMB (poloidal) magnetic energy per order</td></tr><tr><td align="left">12 </td><td align="left">CMB (poloidal) magnetic energy</td></tr></tbody></table></div><p title="kin_spec#.tag"><strong>kin_spec#.tag. </strong>
	Kinetic energy spectra. 
	</p><div class="informaltable"><table border="1"><colgroup><col align="left" class="col1" /><col align="left" class="col2" /></colgroup><thead><tr><th align="center">No. of column </th><th align="center">Contents </th></tr></thead><tbody><tr><td align="left">1 </td><td align="left">degree / order </td></tr><tr><td align="left">2 </td><td align="left">OC poloidal kinetic energy per degree </td></tr><tr><td align="left">3 </td><td align="left">OC poloidal kinetic energy per order </td></tr><tr><td align="left">4 </td><td align="left">OC toroidal kinetic energy per degree </td></tr><tr><td align="left">5 </td><td align="left">OC toroidal kinetic energy per oder </td></tr></tbody></table></div><p title="rot.tag"><strong>rot.tag. </strong>
	Output concerning the rotation of inner core and mantle. This file is writ­ten by <code class="filename">s_write_rot.f</code>.
	</p><div class="informaltable"><table border="1"><colgroup><col align="left" class="col1" /><col align="left" class="col2" /></colgroup><thead><tr><th align="center">No. of column </th><th align="center">Contents </th></tr></thead><tbody><tr><td align="left">1 </td><td align="left">time </td></tr><tr><td align="left">2 </td><td align="left">IC rotation rate </td></tr><tr><td align="left">3 </td><td align="left">Lorentz torque on IC </td></tr><tr><td align="left">4 </td><td align="left">viscous torque on IC </td></tr><tr><td align="left">5 </td><td align="left">mantle rotation rate </td></tr><tr><td align="left">6 </td><td align="left">Lorentz torque on mantle </td></tr><tr><td align="left">7 </td><td align="left">viscous torque on mantle </td></tr></tbody></table></div><p title="rst#.tag"><strong>rst#.tag . </strong>
	Unformatted file that contains all fields and other information to restart or continue a run. Written by subroutine <code class="filename">s_store.f</code>. 
	</p><div class="informaltable"><table border="1"><colgroup><col align="left" class="col1" /><col align="left" class="col2" /></colgroup><tbody><tr><td align="left">Constants:</td><td align="left">time, time step, Rayleigh number, Prandtl number, magnetic Prandtl number, Ekman number, ratio of inner and outer cores radii, inform, number of radial grid points, number of theta grip points, number of phi grid points, basic minc, nalias, number of radial grip points in the inner core, ratio of the conductivities of inner and outer cores</td></tr><tr><td align="left">Arrays:</td><td align="left">pressure, velocity, entropy</td></tr><tr><td align="left">Magnetic Field:</td><td align="left">poloidal magnetic field, toroidal magnetic field, time derivative of poloidal magnetic field, time derivative of toroidal magnetic field</td></tr><tr><td align="left">Magnetic Field (IC):</td><td align="left">poloidal magnetic field, toroidal magnetic field, time derivative of poloidal magnetic field, time derivative of toroidal magnetic field</td></tr><tr><td align="left">Lorentz torques:</td><td align="left">Lorentz torque at the inner core, Lorentz torque at the mantle</td></tr><tr><td align="left">Rotation:</td><td align="left">prescribed IC rotation rate, oscilation frequency of IC rotation rate, time-shifted IC rotation rate, second prescribed IC rotation rate, oscilation frequency of second IC rotation rate, time-shifted second IC rotation rate, prescribed mantle rotation rate, oscilation frequency of mantle rotation rate, time-shifted mantle rotation rate, second prescribed mantle rotation rate, oscilation frequency of second mantle rotation rate, time-shifted mantle rotation rate, updated time step</td></tr></tbody></table></div><p title="G_#.tag/ g_#.tag"><strong>G_#.tag/ g_#.tag. </strong>
	Graphic output files. Names of unformatted (formatted) files start with capital G (little g). Whether the output is formatted or unfomated output is controlled by <span class="emphasis"><em>ngform</em></span>. The files start with a header containing first a string informing about the graphical output version --- the most recents are: Graphout_Version_4 for formatted output and Graphout_Version_5 for unformatted output --- fol­lowed by the runid, plus information about the truncation and dimen­sionless parameters. 
	
		The fields are written in batches for a radial level and a colatitude block. If the code runs on a prallel computer, these batches may not be in the cor­rect order, but can easily put into order with the information in line n. Here n numbers the output batches. The mangetic field is only written for a dynamo run. 
	
		The following table is refered to unformated files only.
	</p><div class="informaltable"><table border="1"><colgroup><col align="left" class="col1" /><col align="left" class="col2" /></colgroup><thead><tr><th align="center">Position  </th><th align="center">Contents  </th></tr></thead><tbody><tr><td align="left">line 1</td><td align="left">String, version information</td></tr><tr><td align="left">line 2</td><td align="left">runid</td></tr><tr><td align="left">line 3</td><td align="left">time, n_r_max, n_theta_max, n_phi_tot, n_r_ic_max-1, minc, nThetaBs</td></tr><tr><td align="left">line 4</td><td align="left">ra, ek, pr, prmag, radratio, sigma_ratio, d_sl (size of the stable layer, relative to the thickness of the outer core)</td></tr><tr><td align="left">line 5</td><td align="left">number of colatitudes, list of colatitudes in graphic output</td></tr><tr><td align="left">line n</td><td align="left">No. of radial level in graphic output radius normalised to , no. of start colatitude in block, no. of last colatitude in block ro  </td></tr><tr><td align="left">line n+1</td><td align="left">entropy for all longitudes and all latitudes in the latitude block  </td></tr><tr><td align="left">line n+2</td><td align="left">radial velocity for all longitudes and all latitudes in the lati­tude block  </td></tr><tr><td align="left">line n+3</td><td align="left">latitudinal velocity for all longitudes and all latitudes in the latitude block  </td></tr><tr><td align="left">line n+4</td><td align="left">zonal velocity for all longitudes and all latitudes in the latitude block  </td></tr><tr><td align="left">line n+5</td><td align="left">radial mangetic field for all longitudes and all latitudes in the latitude block  </td></tr><tr><td align="left">line n+6</td><td align="left">latitudinal magnetic field for all longitudes and all latitudes in the latitude block  </td></tr><tr><td align="left">line n+7</td><td align="left">zonal magnetic field for all longitudes and all latitudes in the latitude block  </td></tr></tbody></table></div><p title="varCond.tag"><strong>varCond.tag . </strong>
	Unformatted file that contains the information about the conductivity profile used. Written by subroutine <code class="filename">s_preCalc.f</code>. 
	</p><div class="informaltable"><table border="1"><colgroup><col align="left" class="col1" /><col align="left" class="col2" /></colgroup><thead><tr><th align="center">No. of column </th><th align="center">Contents </th></tr></thead><tbody><tr><td align="left">1</td><td align="left">radial level</td></tr><tr><td align="left">2</td><td align="left">conductivity</td></tr><tr><td align="left">3</td><td align="left">inverse of the conductivity</td></tr><tr><td align="left">4</td><td align="left">derivative of the inverse of the conductivity</td></tr></tbody></table></div><p title="dtVrms.tag"><strong>dtVrms.tag . </strong>
	Unformatted file that contains the output for RMS force balances. Written by subroutine <code class="filename">s_dtVrms.f</code>. 
	</p><div class="informaltable"><table border="1"><colgroup><col align="left" class="col1" /><col align="left" class="col2" /></colgroup><thead><tr><th align="center">No. of column </th><th align="center">Contents </th></tr></thead><tbody><tr><td align="left">1</td><td align="left">time</td></tr><tr><td align="left">2</td><td align="left">RMS poloidal flow changes: difference between inertia and advection</td></tr><tr><td align="left">3</td><td align="left">RMS toroidal flow changes: difference between inertia and advection</td></tr><tr><td align="left">4</td><td align="left">RMS poloidal Coriolis force</td></tr><tr><td align="left">5</td><td align="left">RMS toroidal Coriolis force</td></tr><tr><td align="left">6</td><td align="left">RMS poloidal Lorentz force</td></tr><tr><td align="left">7</td><td align="left">RMS toroidal Lorentz force</td></tr><tr><td align="left">8</td><td align="left">RMS poloidal advection term</td></tr><tr><td align="left">9</td><td align="left">RMS toroidal advection term</td></tr><tr><td align="left">10</td><td align="left">RMS poloidal diffusion term</td></tr><tr><td align="left">11</td><td align="left">RMS toroidal diffusion term</td></tr><tr><td align="left">12</td><td align="left">RMS Buoyancy term</td></tr><tr><td align="left">13</td><td align="left">RMS Pressure gradient</td></tr><tr><td align="left">14</td><td align="left">RMS sum of forces for the geostrophic balance</td></tr><tr><td align="left">15</td><td align="left">RMS sum of forces for the magnetostrophic balance</td></tr><tr><td align="left">16</td><td align="left">RMS sum of forces for the Archemidian balance (it doesn't work for comparison with the poloidal kinetic energy when using the anelastic approximation, because the density enters the force balance)</td></tr></tbody></table></div><p title="dtBrms.tag"><strong>dtBrms.tag . </strong>
	Unformatted file that contains the output for RMS force balances. Written by subroutine <code class="filename">s_dtBrms.f</code>. 
	</p><div class="informaltable"><table border="1"><colgroup><col align="left" class="col1" /><col align="left" class="col2" /></colgroup><thead><tr><th align="center">No. of column </th><th align="center">Contents </th></tr></thead><tbody><tr><td align="left">1</td><td align="left">time</td></tr><tr><td align="left">2</td><td align="left">RMS poloidal magnetic field changes</td></tr><tr><td align="left">3</td><td align="left">RMS toroidal magnetic field changes</td></tr><tr><td align="left">4</td><td align="left">RMS poloidal stretching</td></tr><tr><td align="left">5</td><td align="left">RMS toroidal stretching</td></tr><tr><td align="left">6</td><td align="left">RMS poloidal advection of the field</td></tr><tr><td align="left">7</td><td align="left">RMS toroidal advection of the field</td></tr><tr><td align="left">8</td><td align="left">RMS poloidal diffusion of the field</td></tr><tr><td align="left">9</td><td align="left">RMS toroidal diffusion of the field</td></tr><tr><td align="left">10</td><td align="left">ratio of RMS omega effect over RMS toroidal stretching</td></tr><tr><td align="left">11</td><td align="left">RMS omega effect</td></tr><tr><td align="left">12</td><td align="left">RMS poloidal dipole dynamo term</td></tr><tr><td align="left">13</td><td align="left">RMS toroidal dipole dynamo term</td></tr></tbody></table></div><p title="dtDrms.tag"><strong>dtDrms.tag . </strong>
	Unformatted file that contains the output for RMS force balances. Written by subroutine <code class="filename">s_dtDrms.f</code>. 
	</p><div class="informaltable"><table border="1"><colgroup><col align="left" class="col1" /><col align="left" class="col2" /></colgroup><thead><tr><th align="center">No. of column </th><th align="center">Contents </th></tr></thead><tbody><tr><td align="left">1</td><td align="left">time</td></tr><tr><td align="left">2</td><td align="left">RMS dipole stretching</td></tr><tr><td align="left">3</td><td align="left">RMS dipole advection term</td></tr><tr><td align="left">4</td><td align="left">RMS dipole diffusion term</td></tr></tbody></table></div><p title="B_coeff_cmb. tag"><strong>B_coeff_cmb. tag. </strong>
	Contains time sequence of poloidal magnetic field coeffitients at the CMB up to degree and order 8. The file is unformatted and follows a special order to save space and time. Itis written by <code class="filename">s_write_b _cmb.f</code>. Please use <code class="filename">s_read_b_cmb.f</code> to extract the time sequences. 
</p><p title="?_mov.tag"><strong>?_mov.tag . </strong>
	The question mark stands for the name that characterizes the movie. This name contains information about the fields and the surface (see above). First comes the field information: Br _, Bt_,Bp, Bh _, B_ (total field), Vr_, Vt_, Vp _, Vh _, V _, T _, FL _(fieldlines), or TAS (toroidal axisymmetric field). Information about the surface is second: CM B , SUR, R=C, T=C, P=C. No information on the surface is needed or the axisymetric fieldlines or the axisymmetric toroidal field. Each movie file consists of a head with information on the movie type, grid, and parameters. (See <code class="filename">s_write_movie_frame.f</code> and <code class="filename">s_get_movie_type.f</code> for details.) The head is followed by the frames, each containing of a line with frame number and time plus one line for each field. I am using an IDL script to extract and display the frames. Please contact me, if you plan to write your own graphic routine and need additional information on the structure of the movie-files.
</p></div><div class="chapter" title="Chapter 4. Subroutines"><div class="titlepage"><div><div><h2 class="title"><a id="chap4"></a>Chapter 4. Subroutines</h2></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl><dt><span class="section"><a href="#id543996">Main code</a></span></dt><dt><span class="section"><a href="#id561887">Common-blocks</a></span></dt></dl></div><p>
	Prefixes are used to identify different types of routines. Generally main programs have no prefix while subroutines have the prefix <code class="filename">s_</code> and functions start with <code class="filename">f_</code>. In addition, all files containing common blocks to 
be included in the routines are marked with the prefix <code class="filename">c_</code>. Subroutines from two JW-libraries are used: <code class="filename">l_char_manip.f</code> and <code class="filename">l_usefull.f</code>. 
</p><div class="section" title="Main code"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id543996"></a>Main code</h2></div></div></div><p title="magic.f"><strong>magic.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_parallel.f, s_get_resetTime (in l_timing.f), s_wallTime (in l_timing.f), s_writeTime (in l_timing.f), s_readNamelists.f, s_openFiles.f, s_checkTruncation.f, s_logWrite.f, s_getBlocking.f, s_preCalc.f, s_pos_at_end (in usefull.f), s_writeNamelists.f, s_getStartFields.f, s_preCalcTimes.f, s_writeInfo.f, s_checkMovie.f, s_step_time.f, s_closeFiles.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_parallel.f, c_logic.f, c_output.f, c_num_param.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Main program.</td></tr></tbody></table></div><p title="s_LMLoop.f"><strong>s_LMLoop.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_step_time.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_parallel.f, c_phys_param.f, c_logic.f, c_radial.f, c_horizontal.f, c_output.f, c_fields.f, c_dt_fieldsLast.f, c_mat.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_safeOpen (in safeOut.f), s_wallTime (in l_timing.f), s_updateS.f, s_updateZ.f, updateWP.f, updateB.f, s_subTime (in l_timing.f), s_writeTime (in l_timing.f), s_safeClose (in safeOut.f)</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Performs the actual time-stepping.</td></tr></tbody></table></div><p title="s_cgesl.f"><strong>s_cgesl.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_updateB.f, s_updateS.f, s_updateWP.f, s_updateZ.f, s_j_cond.f, s_s_cond.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">Solution <span class="emphasis"><em>x</em></span> of the system of equations <span class="emphasis"><em>Ax=b</em></span>.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Backsubstitution of LU-decomposed matricies for linear equation system for one RHS.</td></tr></tbody></table></div><p title="s_cgeslML.f"><strong>s_cgeslML.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_updateB.f, s_updateS.f, s_updateWP.f, s_updateZ.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">Solutions <span class="emphasis"><em>x</em></span> of the systems of equations <span class="emphasis"><em>Ax=b</em></span>, as many systems as the number of blocks.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Backsubstitution of LU-decomposed matricies simultaneously for a number of complex vectors corresponding to the right-hand side.</td></tr></tbody></table></div><p title="s_chebInt.f"><strong>s_chebInt.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Functions / subroutines:  </strong></span></td><td align="left">s_chebIntInit<span class="mathphrase"><sup>1</sup></span>, f_chebInt<span class="mathphrase"><sup>2</sup></span>, f_chebIntD<span class="mathphrase"><sup>3</sup></span></td></tr><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_getEgeos.f<span class="mathphrase"><sup>1,2,3</sup></span>, s_outTO.f<span class="mathphrase"><sup>1,2</sup></span></td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Returns the radial grid points in the actual intervall[r<sub>i</sub>, r<sub>o</sub>] and the asso­ciated points in the Chebyshev interval –(1,1)].</td></tr></tbody></table></div><p title="s_cheb_x _map_e.f"><strong>s_cheb_x _map_e.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_chebInt.f, s_init_rNB.f, s_radial.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">Two arrays, one with the radial levels in radial space [r<sub>i</sub>,r<sub>o</sub>] and the other with the corresponding coordinates in Chebyshev space [-1,1].</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Returns the radial grid points in the actual interval [r<sub>i</sub>, r<sub>o</sub>] and the asso­ciated points in the Chebyshev interval [-1,1]].</td></tr></tbody></table></div><p title="s_cheb_x _map_e_xr.f"><strong>s_cheb_x _map_e_xr.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_radial.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">Two arrays, one with the radial levels in radial space [r<sub>i</sub>,r<sub>o</sub>] and the other with the corresponding coordinates in Chebyshev space [-1,1].</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Returns the radial grid points in the actual interval [r<sub>i</sub>, r<sub>o</sub>] and the asso­ciated points in the Chebyshev interval –(1,1)]. It uses a nonliner mapping (Bayliss &amp; Turkel, 1992).</td></tr></tbody></table></div><p title="s_checkMovie.f"><strong>s_checkMovie.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">magic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_logic.f, c_output.f, c_parallel.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_get_movie_type.f, s_logWrite.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Checks if a movie is desired and, if so, it opens the respective files.</td></tr></tbody></table></div><p title="s_checkTruncation.f"><strong>s_checkTruncation.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">magic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Checks the truncations defined in truncation.f and writes them into STDOUT and the log-file.</td></tr></tbody></table></div><p title="s_check_time_hits.f"><strong>s_check_time_hits.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_step_time.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_output.f, c_num_param.f, c_logic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">Logical variable that indicates if the time step has been changed, real values of the previous time and time step and of the new time step.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">l_usefull.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Checks whether a desired time t<sub>a</sub> (f.e. for a graphic output) falls into the intervall [t,t+δt], where <span class="emphasis"><em>t</em></span> is the current stepping time, and δt is the time step. If this is true, δt is changed so that the next time step will hit t<sub>a</sub> exa­ctly.</td></tr></tbody></table></div><p title="s_closeFiles.f"><strong>s_closeFiles.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">magic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_logic.f, c_output.f, c_parallel.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">Logical variable that indicates if the time step has been changed, real values of the previous time and time step and of the new time step.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Defines the names and the unit for the output files, and it opens them.</td></tr></tbody></table></div><p title="s_costf1.f"><strong>s_costf1.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">f_rInt.f, f_rIntIC.f, f_rInt_R.f, f_chebInt (in s_chebInt.f), f_chebIntD (in s_chebInt.f), s_getEgeos.f, s_get_dr.f, s_get_ddr.f, s_get_dddr.f, s_get_ddr_even.f, s_get_drNS.f, s_get_drNS_even.f, s_mapDataICR.f, s_mapDataR.f, s_outOmega.f, s_outTO.f, s_storePot.f, s_j_cond.f, s_s_cond.f, s_updateB.f, s_updateS.f, s_updateWP.f, s_updateZ.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">check_dim.f (in l_usefull.f), s_fft_fac.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Performs a multiple cosine transform of the first kind (see f.e. numerical recipes).</td></tr></tbody></table></div><p title="s_costf2.f"><strong>s_costf2.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_get_dr_even.f, s_get_ddr_even.f, s_get_drNS_even.f, s_get_ddrNS_even.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">check _dim.f (in l_usefull.f), s_fft_fac.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Performs a multiple cosine transform of the second kind (see f.e. numerical recipes).</td></tr></tbody></table></div><p title="s_courant.f"><strong>s_courant.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_radialLoopG.f, s_step_time.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_num_param.f, c_phys_param.f, c_radial.f, c_horizontal.f, c_logic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">Two Courant advection lengths in radial and horizontal directions, for a specified radial level.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates advection length and length associated with the modified Alfen ­velocity necessary to check the Courant condition (see s_dt_courant.f).</td></tr></tbody></table></div><p title="s_defaultNamelists.f"><strong>s_defaultNamelists.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_readNamelists.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_phys_param.f, c_num_param.f, c_logic.f, c_init_fields.f, c_output.f, c_TO.f, c_parallel.f, c_Grenoble.f, c_radial.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Sets default namelist parameters to default values.</td></tr></tbody></table></div><p title="s_dtBrms.f"><strong>s_dtBrms.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_output.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_parallel.f, c_blocking.f, c_num_param.f, c_output.f, c_radial.f, c_horizontal.f, c_const.f, c_logic.f, c_phys_param.f, c_dtB.f, c_RMS.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">new movie output: 'nField', 'nFields', 'nFieldSize', 'nTheta', 'nThetaB', 'nThetaN', 'nThetaS', 'nThetaStart', 'nPos', ...</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_get_drNS.f, s_get_PolTorRms.f, s_hInt2dPol.f, s_pos_at_end (in l_usefull.f), s_get_RAS.f, s_get_PASLM.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates RMS output for the magnetic field.</td></tr></tbody></table></div><p title="s_dtVrms.f"><strong>s_dtVrms.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_output.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_parallel.f, c_blocking.f, c_phys_param.f, c_radial.f, c_const.f, c_logic.f, c_output.f, c_RMS.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">...</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_init_rNB.f, s_get_drNS_R.f, s_hInt2dPol.f, s_pos_at_end (in l_usefull.f)</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Test the RMS balance and determines the necessary amount of radius being cut to exclude the boundaries.</td></tr></tbody></table></div><p title="s_dt_courant.f"><strong>s_dt_courant.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_step_time.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_output.f, c_logic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_pos_at_end (in l_usefull.f)</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Checks whether time step should be changed because of violation of the Courant criteria. Time step is modified accordingly, checking whether it is in the allowed interval of [<span class="emphasis"><em>dtmin</em></span>,<span class="emphasis"><em>dtmax</em></span>] (see input parameters).</td></tr></tbody></table></div><p title="s_factorise.f"><strong>s_factorise.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_init_costf1.f, s_init_costf2.f, s_init_fft.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Factorises the number of radial grid points for the cos-transform, into the factors given in an array.</td></tr></tbody></table></div><p title="s_fftJW.f"><strong>s_fftJW.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_fft_theta.f, s_fft_thetab.f, s_fft_thetas.f, s_getDVptr.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_fft99bJW (in s_fftJW.f), s_wpass2JW (in s_fftJW.f), s_wpass3JW (in s_fftJW.f), s_wpass4JW (in s_fftJW.f), s_wpass5JW (in s_fftJW.f)</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Performs a complex Fourier transform.</td></tr></tbody></table></div><p title="s_fft_fac.f"><strong>s_fft_fac.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_costf1.f, s_costf2.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Performs a complex Fourier transform.</td></tr></tbody></table></div><p title="s_fft_thetab.f"><strong>s_fft_thetab.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_fields_average.f, s_get_B_surface.f, s_get_Bpol.f, s_get_Btor.f, s_get_br_v_bcs.f, s_get_dtBLM.f, s_graphOut_IC.f, s_initS.f, s_initV.f, s_lm2pt.f, s_radialLoopG.f, s_store_movie_frame_IC.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_horizontal.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_fftJW.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Contains the Fourier transform of a theta block.</td></tr></tbody></table></div><p title="s_fields_average.f"><strong>s_fields_average.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_output.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_num_param.f, c_output.f, c_blocking.f, c_logic.f, c_const.f, c_radial.f, c_horizontal.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_get_drNS.f, s_get_drNS_even.f, s_spectrum.f, s_pos_at_end (in l_usefull.f), s_get_e_kin.f, s_get_e_mag.f, s_graphOut.f, s_legPrep.f, s_legTF.f, s_fft_thetab.f, s_graphOut_IC.f, s_write_Bcmb.f, s_storePotW.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Performs on the fly averaging of velocity, magnetic and entroy field in (<span class="emphasis"><em>r,l,m</em></span>)-space if <span class="emphasis"><em>l_averag=.true.</em></span>. After the last time step or after a kill ­30 command, the averaged fields in physical space (r,θ,φ) are calculated and written into a graphic output file. In addition, the averaged spectra and energies are calculated.</td></tr></tbody></table></div><p title="s_gauleg.f"><strong>s_gauleg.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_horizontal.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Returns colatitudes and weights for the Gauss-Legendre transformation in colatitude direction.</td></tr></tbody></table></div><p title="s_getAStr.f"><strong>s_getAStr.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_outTO.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Obtains the output of the axisymmettric zonal flow, its relative strength, its time variation and the forces acting on it.</td></tr></tbody></table></div><p title="s_getBlocking.f"><strong>s_getBlocking.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">magic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_output.f, c_blocking.f, c_parallel.f, c_logic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_pos_at_end (in l_usefull.f), OMP_SET_NUM_THREADS</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Sets the thread number, checks how many are available and calculates blocking parameters for the blocking loops.</td></tr></tbody></table></div><p title="s_getDVptr.f"><strong>s_getDVptr.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_getEgeos.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_radial.f, c_horizontal.f, c_const.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_fftJW.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates the three flow components.</td></tr></tbody></table></div><p title="s_getDlm.f"><strong>s_getDlm.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_output.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_num_param.f, c_horizontal.f, c_phys_param.f, c_radial.f, c_const.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates the poloidal and toroidal kinetic energies and writes these into the appropriate output file.</td></tr></tbody></table></div><p title="s_getEgeos.f"><strong>s_getEgeos.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_outMisc.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_phys_param.f, c_num_param.f, c_horizontal.f, c_radial.f, c_blocking.f, c_const.f, c_output.f, c_logic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_costf1.f, s_chebIntInit.f, s_plm_theta.f, s_getDVptr.f, s_pos_at_end (in l_usefull.f)</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates output related to the axisymmetric zonal flow: it's relative strength, time variation and the forces acting on it, using a cylindrical grid.</td></tr></tbody></table></div><p title="s_getHelLM.f"><strong>s_getHelLM.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_radialLoopG.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_horizontal.f, c_num_param.f, c_phys_param.f, c_radial.f, c_logic.f, c_output.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_legtfAS2.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">Two one-dimensional arrays with the helicities and square of the helicities, for each degree <span class="emphasis"><em>l</em></span> and for one specified radial level.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates the axisymmetric contributions of helicity and helicity squared, in (<span class="emphasis"><em>r,l,m=0</em></span>) space.</td></tr></tbody></table></div><p title="s_getPAStr.f"><strong>s_getPAStr.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_outTO.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_horizontal.f, c_num_param.f, c_phys_param.f, c_radial.f, c_logic.f, c_blocking.f, c_const.f, c_output.f, c_TO.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_legtfAS.f, s_legtfAS2.f, s_costf1.f, s_int2string (in l_char_manip.f), s_chebIntInit.f, s_plm_theta.f, s_getPAStr.f, s_getAStr.f, s_pos_at_end (in l_usefull.f), s_get_PAS.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">Two one-dimensional arrays with the helicities and square of the helicities, for each degree <span class="emphasis"><em>l</em></span> and for one specified radial level.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates the axisymmetric contributions of helicity and helicity squared, in (<span class="emphasis"><em>r,l,m=0</em></span>) space.</td></tr></tbody></table></div><p title="s_getStartFields.f"><strong>s_getStartFields.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">magic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_phys_param.f, c_num_param.f, c_const.f, c_radial.f, c_horizontal.f, c_init_fields.f, c_blocking.f, c_logic.f, c_output.f, c_fields.f, c_dt_fieldsLast.f, c_Grenoble.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_readStartFields.f, s_logWrite.f, s_s_cond.f, s_get_dr.f, s_initB.f, s_initV.f, s_initS.f, s_get_ddr.f, s_get_ddr_even.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">Two one-dimensional arrays with the helicities and square of the helicities, for each degree <span class="emphasis"><em>l</em></span> and for one specified radial level.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates the axisymmetric contributions of helicity and helicity squared, in (<span class="emphasis"><em>r,l,m=0</em></span>) space.</td></tr></tbody></table></div><p title="s_getTO.f"><strong>s_getTO.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_radialLoopG.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_horizontal.f, c_num_param.f, c_phys_param.f, c_radial.f, c_logic.f, c_output.f, c_TO.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_legtfAS2.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">Two one-dimensional arrays with the helicities and square of the helicities, for each degree <span class="emphasis"><em>l</em></span> and for one specified radial level.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates the axisymmetric contributions of helicity and helicity squared, in (<span class="emphasis"><em>r,l,m=0</em></span>) space.</td></tr></tbody></table></div><p title="s_getTOfinish.f"><strong>s_getTOfinish.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_radialLoopG.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_horizontal.f, c_num_param.f, c_phys_param.f, c_radial.f, c_logic.f, c_output.f, c_TO.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">Two one-dimensional arrays with the helicities and square of the helicities, for each degree <span class="emphasis"><em>l</em></span> and for one specified radial level.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates the axisymmetric contributions of helicity and helicity squared, in (<span class="emphasis"><em>r,l,m=0</em></span>) space.</td></tr></tbody></table></div><p title="s_getTOnext.f"><strong>s_getTOnext.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_radialLoopG.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_horizontal.f, c_num_param.f, c_phys_param.f, c_radial.f, c_logic.f, c_output.f, c_TO.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">Two one-dimensional arrays with the helicities and square of the helicities, for each degree <span class="emphasis"><em>l</em></span> and for one specified radial level.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates the axisymmetric contributions of helicity and helicity squared, in (<span class="emphasis"><em>r,l,m=0</em></span>) space.</td></tr></tbody></table></div><p title="s_get_B_surface.f"><strong>s_get_B_surface.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_store_movie_frame.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_radial.f, c_horizontal.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_fft_thetab.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates the magnetic field components at the Earth's surface.</td></tr></tbody></table></div><p title="s_get_Bpol.f"><strong>s_get_Bpol.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_write_dtB_frame.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_num_param.f, c_radial.f, c_horizontal.f, c_logic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_fft_thetab.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates the components of the poloidal magnetic field at a specified radial grid point and the block of all theta grid points.</td></tr></tbody></table></div><p title="s_get_Btor.f"><strong>s_get_Btor.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_write_dtB_frame.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_num_param.f, c_radial.f, c_horizontal.f, c_logic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_fft_thetab.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates the components of the toroidal magnetic field at a specified radial grid point and the block of all theta grid points.</td></tr></tbody></table></div><p title="s_get_PAS.f"><strong>s_get_PAS.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_outTO.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_num_param.f, c_radial.f, c_horizontal.f, c_logic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates the components of the poloidal magnetic field at a specified radial grid point and the block of all theta grid points.</td></tr></tbody></table></div><p title="s_get_PASLM.f"><strong>s_get_PASLM.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_dtBrms.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_num_param.f, c_radial.f, c_horizontal.f, c_logic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates the components of the poloidal magnetic field at a specified radial grid point and the block of all theta grid points.</td></tr></tbody></table></div><p title="s_get_PolTorRms.f"><strong>s_get_PolTorRms.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_dtBrms.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_const.f, c_radial.f, c_horizontal.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates the components of the poloidal magnetic field at a specified radial grid point and the block of all theta grid points.</td></tr></tbody></table></div><p title="s_get_RAS.f"><strong>s_get_RAS.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_dtBrms.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_num_param.f, c_radial.f, c_horizontal.f, c_logic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates the components of the poloidal magnetic field at a specified radial grid point and the block of all theta grid points.</td></tr></tbody></table></div><p title="s_get_angular_moment.f"><strong>s_get_angular_moment.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_updateZ.f, s_write_rot.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_const.f, c_radial.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates the angular momentum of the outer core, the inner core and the mantle.</td></tr></tbody></table></div><p title="s_get_bMat.f"><strong>s_get_bMat.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_updateB.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_phys_param.f, c_num_param.f, c_radial.f, c_logic.f, c_init_fields.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_sgefa.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates the implicit time step matrix for the poloidal and toroidal ma­gnetic field potentials and returns their LU-decomposition.</td></tr></tbody></table></div><p title="s_get_b_nl_bcs.f"><strong>s_get_b_nl_bcs.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_step_time.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_horizontal.f, c_phys_param.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates the nonlinear term of the magnetic boundary condition for a conducting mantle in the physical space.</td></tr></tbody></table></div><p title="s_get_br_v_bcs.f"><strong>s_get_br_v_bcs.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_radialLoopG.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_horizontal.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_fft_thetab.f, s_legTF2.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates terms for the nonlinear magnetic boundary condition in the ap­proximation for a small mantle conductance. The actual BC is finished by <code class="filename">s_get_mag_nl_cmb.f</code> (see below).</td></tr></tbody></table></div><p title="s_get_chebs.f"><strong>s_get_chebs.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_radial.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_check_dim (in l_usefull.f)</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates Chebyshev polynomials and their first, second and third deriva­tive at the points returned by <span class="emphasis"><em>s_cheb_x_map_e.f</em></span>.</td></tr></tbody></table></div><p title="s_get_chebs_even.f"><strong>s_get_chebs_even.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_radial.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_check_dim (in l_usefull.f)</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Same as <code class="filename">s_get_chebs.f</code>, but calculates only the even polynomials.</td></tr></tbody></table></div><p title="s_get_dH_dtBLM.f"><strong>s_get_dH_dtBLM.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_radialLoopG.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_horizontal.f, c_phys_param.f, c_num_param.f, c_radial.f, c_logic.f, c_dtB.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates theta and phi derivatives related terms of the magnetic production and advection terms.</td></tr></tbody></table></div><p title="s_get_dcheb.f"><strong>s_get_dcheb.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">f_chebIntD (in s_chebInt.f), s_get_dr.f, s_get_dr_even.f, s_get_drNS.f, s_get_drNS_even.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">Two-dimensional array of the Chebyshev coefficients of the first derivative of the input function (the first dimensional is for parallelization).</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Returns the Chebyshev coefficients of the first derivative (<span class="emphasis"><em>df</em></span>) and of the second derivative (<span class="emphasis"><em>ddf</em></span>) for a function <span class="emphasis"><em>f</em></span>.</td></tr></tbody></table></div><p title="s_get_dcheb_even.f"><strong>s_get_dcheb_even.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_get_dr_even.f, s_get_drNS_even.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Returns the even Chebyshev coefficients of the first derivative (<span class="emphasis"><em>df</em></span>) and of the second derivative (<span class="emphasis"><em>ddf</em></span>) for a function <span class="emphasis"><em>f</em></span>, for the inner core.</td></tr></tbody></table></div><p title="s_get_ddcheb.f"><strong>s_get_ddcheb.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_get_ddr_even.f, s_get_ddrNS_even.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Returns the Chebyshev coefficients of the first derivative (<span class="emphasis"><em>df</em></span>) and of the second derivative (<span class="emphasis"><em>ddf</em></span>) for a function <span class="emphasis"><em>f</em></span>.</td></tr></tbody></table></div><p title="s_get_ddcheb_even.f"><strong>s_get_ddcheb_even.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_get_ddr_even.f, s_get_ddrNS_even.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Returns the even Chebyshev coefficients of the first derivative (<span class="emphasis"><em>df</em></span>) and of the second derivative (<span class="emphasis"><em>ddf</em></span>) for a function <span class="emphasis"><em>f</em></span>, for the inner core.</td></tr></tbody></table></div><p title="s_get_dddcheb.f"><strong>s_get_dddcheb.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_get_dddr.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Returns the Chebyshev coefficients of the first derivative (<span class="emphasis"><em>df</em></span>) and of the second derivative (<span class="emphasis"><em>ddf</em></span>) for a function <span class="emphasis"><em>f</em></span>.</td></tr></tbody></table></div><p title="s_get_dddr.f"><strong>s_get_dddr.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_updateWP.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_costf1.f, s_get_dddcheb.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Similar to <code class="filename">s_get_dcheb.f</code> ....buthere the radial derivatives are calculated in radial grid space using a Chebyshev-transform.</td></tr></tbody></table></div><p title="s_get_ddr.f"><strong>s_get_ddr.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_updateB.f, s_updateS.f, s_updateZ.f, s_getStarFields.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_costf1.f, s_get_ddcheb.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Similar to <code class="filename">s_get_dcheb.f</code> ....buthere the radial derivatives are calculated in radial grid space using a Chebyshev-transform.</td></tr></tbody></table></div><p title="s_get_ddrNS_even.f"><strong>s_get_ddrNS_even.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_fields_average.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_get_ddcheb_even.f, s_costf1.f, s_costf2.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Similar to <code class="filename">s_get_dcheb.f</code>... but here the radial derivatives are calculated in radial grid space using a Chebyshev-transform.</td></tr></tbody></table></div><p title="s_get_ddr_even.f"><strong>s_get_ddr_even.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_updateB.f, s_getStarFields.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_costf1.f, s_get_ddcheb_even.f, s_costf2.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">c_logic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Similar to <code class="filename">s_get_dcheb.f</code>... but here the radial derivatives are calculated in radial grid space using a Chebyshev-transform.</td></tr></tbody></table></div><p title="s_get_dr.f"><strong>s_get_dr.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_get_dr_R.f, s_updateWP.f, s_updateS.f, s_init_rNB.f, s_getStarFields.f, s_preCalc.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_costf1.f, s_get_dcheb.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">Two-dimensional array of the first radial derivative of the input function (the first dimension of the array is for the parallelization).</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Similar to <code class="filename">s_get_dcheb.f</code> ....buthere the radial derivatives are calculated in radial grid space using a Chebyshev-transform.</td></tr></tbody></table></div><p title="s_get_drNS.f"><strong>s_get_drNS.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_dtBrms.f, s_fields_average.f, s_get_drNS_R.f, s_get_dtBLMfinish.f, s_udateB.f, s_write_dtB_frame.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_costf1.f, s_get_dcheb.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Similar to <code class="filename">s_get_dcheb.f</code> ....buthere the radial derivatives are calculated in radial grid space using a Chebyshev-transform.</td></tr></tbody></table></div><p title="s_get_drNS_R.f"><strong>s_get_drNS_R.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_dtVrms.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_get_drNS.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Similar to <code class="filename">s_get_dcheb.f</code> ....buthere the radial derivatives are calculated in radial grid space using a Chebyshev-transform.</td></tr></tbody></table></div><p title="s_get_drNS_even.f"><strong>s_get_drNS_even.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_fields_average.f, s_write_dtB_frame.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_costf1.f, s_get_dcheb_even.f, s_costf2.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Similar to <code class="filename">s_get_dcheb.f</code> ....buthere the radial derivatives are calculated in radial grid space using a Chebyshev-transform.</td></tr></tbody></table></div><p title="s_get_dtB.f"><strong>s_get_dtB.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_write_dtB_frame.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_radial.f, c_horizontal.f, c_logic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left"> </td></tr></tbody></table></div><p title="s_get_dtBLM.f"><strong>s_get_dtBLM.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_radialLoopG.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_horizontal.f, c_num_param.f, c_phys_param.f, c_radial.f, c_logic.f, c_blocking.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_fft_thetab.f, s_legTF3.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">Fourteen one-dimensional arrays with the nonlinear products of the magnetic field (production and advection), in grid space (<span class="emphasis"><em>r,θ,φ</em></span>).</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates nonlinear products for one specific radial level.</td></tr></tbody></table></div><p title="s_get_dtBLMfinish.f"><strong>s_get_dtBLMfinish.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_output.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_horizontal.f, c_phys_param.f, c_radial.f, c_logic.f, c_blocking.f, c_dtB.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_get_drNS.f, s_rBrSpec.f, s_rBpSpec.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Accesses the r-distributed fields TstrRLM, TadvRLM, TomeRLM, fields in c_dtB.f and the LM-distributed scalar fields b, ddb, aj, ddj, b_ic, db_ic, ddb_ic, aj_ic, dj_ic, ddj_ic.</td></tr></tbody></table></div><p title="s_get_e_kin.f"><strong>s_get_e_kin.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_fields_average.f, s_output.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_num_param.f, c_radial.f, c_horizontal.f, c_output.f, c_logic.f, c_const.f, c_phys_param.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">pos_at_end.f (in l_usefull.f)</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates the poloidal and toroidal kinetic energies and writes these into the appropriate output file.</td></tr></tbody></table></div><p title="s_get_e_mag.f"><strong>s_get_e_mag.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_fields_average.f, s_output.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">pos_at_end.f (in l_usefull.f)</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_horizontal.f, c_phys_param.f, c_num_param.f, c_const.f, c_radial.f, c_logic.f, c_output.f, c_movie.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates the poloidal and toroidal magnetic energies and writes these into the appropriate output file.</td></tr></tbody></table></div><p title="s_get_fl.f"><strong>s_get_fl.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_store_movie_frame.f, s_store_movie_frame_IC.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_radial.f, c_fields.f, c_horizontal.f, c_logic.f, c_Grenoble.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculate scalar field necessary to draw fieldlines of the axisymmetric po­loidal magnetic field in a meridional cut.</td></tr></tbody></table></div><p title="s_get_hit_times.f"><strong>s_get_hit_times.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_prepCalcTimes.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates the times for the different output types.</td></tr></tbody></table></div><p title="s_get_lorentz_torque.f"><strong>s_get_lorentz_torque.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_radialLoopG.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_radial.f, c_horizontal.f, c_Grenoble.f, c_phys_param.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">Lorentz torque for the specified radial level (either inner core or mantle, in this code).</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates Lorentz-torque contribution (of the colatitude block) on inner core or mantle.</td></tr></tbody></table></div><p title="s_get_movie_type.f"><strong>s_get_movie_type.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_checkMovie.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_output.f, c_phys_param.f, c_radial.f, c_logic.f, c_movie.f, c_horizontal.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_delete_string (in l_char_manip.f), s_capitalize (in l_char_manip.f), s_get_next_dble (in l_char_manip.f), s_pos_at_end (in l_char_manip.f), </td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Indentifies the desired movies from the input strin array <span class="emphasis"><em>movie()</em></span> and sets the necessary parameters for the run.</td></tr></tbody></table></div><p title="s_get_nl.f"><strong>s_get_nl.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_radialLoopG.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_horizontal.f, c_num_param.f, c_phys_param.f, c_radial.f, c_logic.f, c_blocking.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates nonlinear products for each radial level.</td></tr></tbody></table></div><p title="s_get_power.f"><strong>s_get_power.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_output.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_horizontal.f, c_phys_param.f, c_num_param.f, c_radial.f, c_logic.f, c_output.f, c_movie.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_get_viscous_torque.f, s_pos_at_end (in l_usefull.f)</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates power and dissipation of the core/mantle system.</td></tr></tbody></table></div><p title="s_get_s0Mat.f"><strong>s_get_s0Mat.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_updateS.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_phys_param.f, c_num_param.f, c_radial.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_sgefa.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">Matrix (2-dimensional array) for the entropy equation, for an given time-step. One-dimensional array of the <span class="emphasis"><em>pivots</em></span> for the matrix.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Constructs the time step matrix sMat0.</td></tr></tbody></table></div><p title="s_get_sMat.f"><strong>s_get_sMat.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_updateS.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_phys_param.f, c_num_param.f, c_radial.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_sgefa.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">Matrix (2-dimensional array) for the entropy equation, for an given time-step. One-dimensional array of the <span class="emphasis"><em>pivots</em></span> for the matrix.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates the implicit time step matrix for the entropy field and returns the LU-decomposition.</td></tr></tbody></table></div><p title="s_get_sl.f"><strong>s_get_sl.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_store_movie_frame.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_radial.f, c_fields.f, c_horizontal.f, c_logic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Returns the field whose contourlines are the streamlines of the axisymmetric poloidal velocity field.</td></tr></tbody></table></div><p title="s_get_td.f"><strong>s_get_td.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_radialLoopG.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_horizontal.f, c_phys_param.f, c_num_param.f, c_radial.f, c_logic.f, c_RMS.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_hInt2Pol.f, s_hInt2Tor.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">Six one-dimensional arrays with the time derivatives of the poloidal and toroidal components of velocity and magnetic fields, and time derivatives of the scalar fields entropy and pressure. Two one-dimensional arrays of nonlinear terms in spectral form.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates first part of the explicit time step terms.</td></tr></tbody></table></div><p title="s_get_u_square.f"><strong>s_get_u_square.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_output.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_num_param.f, c_radial.f, c_horizontal.f, c_output.f, c_logic.f, c_const.f, c_phys_param.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_pos_at_end (in l_usefull.f), s_hInt2Pol.f, s_hInt2Tor.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates square velocity terms: kinetic ebergy, Reynolds number, Rossby number and velocity length scale.</td></tr></tbody></table></div><p title="s_get_viscous_torque.f"><strong>s_get_viscous_torque.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_get_power.f, s_write_rot.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates viscous torque on inner core or mantle.</td></tr></tbody></table></div><p title="s_get_wpMat.f"><strong>s_get_wpMat.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_updateWP.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_phys_param.f, c_num_param.f, c_radial.f, c_logic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_sgefa.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Constructs the time step matricies Z and WP for the Navier Stokes equation.</td></tr></tbody></table></div><p title="s_get_z10Mat.f"><strong>s_get_z10Mat.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_updateZ.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_sgefa.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_phys_param.f, c_num_param.f, c_const.f, c_radial.f, c_logic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates the implicit time step matrix for the toroidal velocity potential (l=1,m=0) if rigid boundary conditions have been chosen and returns the LU-decomposition.</td></tr></tbody></table></div><p title="s_get_zMat.f"><strong>s_get_zMat.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_updateZ.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_phys_param.f, c_num_param.f, c_radial.f, c_logic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_sgefa.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Constructs the time step matricies Z and WP for the Navier Stokes equation.</td></tr></tbody></table></div><p title="s_graphOut.f"><strong>s_graphOut.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_fields_average.f, s_radialLoopG.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_horizontal.f, c_phys_param.f, c_num_param.f, c_radial.f, c_logic.f, c_blocking.f, c_output.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_graph_write.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Master for graphic output of outer core data.</td></tr></tbody></table></div><p title="s_graphOut_IC.f"><strong>s_graphOut_IC.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_fields_average.f, s_output.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_num_param.f, c_radial.f, c_horizontal.f, c_logic.f, c_output.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_legPrep_IC.f, s_legTF.f, s_fft_thetab.f, s_graph_write.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Master for graphic output of inner core data.</td></tr></tbody></table></div><p title="s_graph_write.f"><strong>s_graph_write.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_graphOut.f, s_graphOut_IC.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Writes graphic output into appropriate output file.</td></tr></tbody></table></div><p title="s_hInt2Pol.f"><strong>s_hInt2Pol.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_get_td.f, s_updateB.f, s_updateWP.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_const.f, c_radial.f, c_horizontal.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left"> </td></tr></tbody></table></div><p title="s_hInt2Tor.f"><strong>s_hInt2Tor.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_get_td.f, s_updateB.f, s_updateZ.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_radial.f, c_horizontal.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left"> </td></tr></tbody></table></div><p title="s_hInt2dPol.f"><strong>s_hInt2dPol.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_dtBrms.f, s_dtVrms.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_radial.f, c_horizontal.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left"> </td></tr></tbody></table></div><p title="s_horizontal.f"><strong>s_horizontal.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_preCalc.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_phys_param.f, c_num_param.f, c_horizontal.f, c_radial.f, c_logic.f, c_output.f, c_blocking.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_gauleg.f, s_plm_theta.f, s_init_fft.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates functions of theta and phi, for example the Legendre functions, and functions of degree <span class="emphasis"><em>l</em></span> and order <span class="emphasis"><em>m</em></span> of the legendres.</td></tr></tbody></table></div><p title="s_initB.f"><strong>s_initB.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_getStartFields.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_phys_param.f, c_num_param.f, c_radial.f, c_horizontal.f, c_logic.f, c_init_fields.f, c_Grenoble.f, c_const.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_getB0.f, s_j_cond.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Initializes magnetic field (see above).</td></tr></tbody></table></div><p title="s_initS.f"><strong>s_initS.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_getStartFields.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_phys_param.f, c_num_param.f, c_radial.f, c_const.f, c_horizontal.f, s_init_fields.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_s_cond.f, s_legTF1.f, s_fft_thetab.f, s_sgefa.f, s_sgesl.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Initializes entropy field (see above).</td></tr></tbody></table></div><p title="s_initV.f"><strong>s_initV.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_getStartFields.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_phys_param.f, c_num_param.f, c_radial.f, c_horizontal.f, c_init_fields.f, c_const.f, c_logic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_legTF1.f, s_fft_thetab.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Initializes velocity field (see above).</td></tr></tbody></table></div><p title="s_init_costf1.f"><strong>s_init_costf1.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_chebIntInit (in s_chebInt.f), s_init_rNB.f, s_mapDataICR.f, s_mapDataR.f, s_radial.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_factorise.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Initializes cos-transform of the first kind.</td></tr></tbody></table></div><p title="s_init_costf2.f"><strong>s_init_costf2.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_radial.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_factorise.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Initializes cos-transform of the second kind.</td></tr></tbody></table></div><p title="s_init_fft.f"><strong>s_init_fft.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_horizontal.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_factorize.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates and stores several values that will be needed for a fast Fourier transform (performed by s_fftJW).</td></tr></tbody></table></div><p title="s_init_rNB.f"><strong>s_init_rNB.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_dtVrms.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_cheb_x_map_e.f, s_init_costf1.f, s_get_dr.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Prepares the usage of a cut back radial gril where a requested number of points is discarded on both boundaries.</td></tr></tbody></table></div><p title="s_j_cond.f"><strong>s_j_cond.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_initB.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_horizontal.f, c_phys_param.f, c_radial.f, c_init_fields.f, c_logic.f, c_mat.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_costf1.f, s_sgefa.f, s_cgesl.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Solves diffusion equation for the initialized magnetic toroidal field (see above).</td></tr></tbody></table></div><p title="s_legPrep.f"><strong>s_legPrep.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_fields_average.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates help arrays for the calculation and Legendre transform of the different fields.</td></tr></tbody></table></div><p title="s_legPrepG.f"><strong>s_legPrepG.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_radialLoopG.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_num_param.f, c_radial.f, c_horizontal.f, c_logic.f, c_const.f, c_blocking.f, c_Grenoble.f, c_fields.f, c_TO.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates help arrays for the calculation and Legendre transform of the different fields.</td></tr></tbody></table></div><p title="s_legPrep_IC.f"><strong>s_legPrep_IC.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_graphOut_IC.f, s_store_movie_frame_IC.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates help arrays for the calculation and Legendre transform of the different fields.</td></tr></tbody></table></div><p title="s_legTF.f"><strong>s_legTF.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_fields_average.f, s_graphOut_IC.f, s_store_movie_frame_IC.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates all three spherical components of a field as well as its curl, giving them in the spherical harmonics poloidal/toroidal decomposition.</td></tr></tbody></table></div><p title="s_legTF1.f"><strong>s_legTF1.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_initS.f, s_initV.f, s_radialLoopG.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_horizontal.f, c_blocking.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Legendre transform...</td></tr></tbody></table></div><p title="s_legTF2.f"><strong>s_legTF2.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_get_br_v_bcs.f, s_get_dtBLM.f, s_radialLoopG.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_horizontal.f, c_blocking.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Legendre transform...</td></tr></tbody></table></div><p title="s_legTF3.f"><strong>s_legTF3.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_get_dtBLM.f, s_radialLoopG.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_horizontal.f, c_blocking.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Legendre transform...</td></tr></tbody></table></div><p title="s_legTFG.f"><strong>s_legTFG.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_radialLoopG.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_horizontal.f, c_logic.f, c_const.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Legendre transform from spectral space (<span class="emphasis"><em>nR,l,m</em></span>) to grid space (<span class="emphasis"><em>nR,nTheta,m</em></span>), where <span class="emphasis"><em>nTheta</em></span> is the number of colatitudes and <span class="emphasis"><em>l</em></span> is the degree of the spherical harmonic representation.</td></tr></tbody></table></div><p title="s_legTFGnomag.f"><strong>s_legTFGnomag.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_radialLoopG.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_horizontal.f, c_logic.f, c_const.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Legendre transform from spectral space (<span class="emphasis"><em>nR,l,m</em></span>) to grid space (<span class="emphasis"><em>nR,nTheta,m</em></span>), where <span class="emphasis"><em>nTheta</em></span> is the number of colatitudes and <span class="emphasis"><em>l</em></span> is the degree of the spherical harmonic representation.</td></tr></tbody></table></div><p title="s_legtfAS.f"><strong>s_legtfAS.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_outTO.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_horizontal.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Given the results from <code class="filename">s_leg_prep.f</code> this routine calculates all fields and the necessary radial derivatives in (<span class="emphasis"><em>r</em></span>,θ,<span class="emphasis"><em>m</em></span>)-space.</td></tr></tbody></table></div><p title="s_legtfAS2.f"><strong>s_legtfAS2.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_getHelLM.f, s_getTO.f, s_outTO.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_horizontal.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Same as <code class="filename">s_legtf.f</code> but does not treat the magnetic field.</td></tr></tbody></table></div><p title="s_lm2pt.f"><strong>s_lm2pt.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_write_dtB_frame.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_horizontal.f, c_blocking.f, c_radial.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_fft_thetab.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Performs a spherical harmonic transform.</td></tr></tbody></table></div><p title="s_lmAS2pt.f"><strong>s_lmAS2pt.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_outMisc.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_horizontal.f, c_radial.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Performs a spherical harmonic transform.</td></tr></tbody></table></div><p title="s_logWrite.f"><strong>s_logWrite.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">magic.f, s_checkMovie.f, s_getStartFields.f, s_output.f, s_preCalc.f, s_step_time.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_output.f, c_parallel.f, c_logic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_pos_at_end (in l_usefull.f)</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left"> </td></tr></tbody></table></div><p title="s_mapData.f"><strong>s_mapData.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_readStartFields.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_init_fields.f, c_radial.f, c_blocking.f, c_logic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_mapDataR.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Reads fields from startfile and call <code class="filename">s_copy_data.f</code> to map to a different grid if required.</td></tr></tbody></table></div><p title="s_mapDataIC.f"><strong>s_mapDataIC.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_readStartFields.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_radial.f, c_init_fields.f, c_blocking.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_mapDataICR.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Same as <code class="filename">s_map_data.f</code> but for inner core.</td></tr></tbody></table></div><p title="s_mapDataICR.f"><strong>s_mapDataICR.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_mapDataIC.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_radial.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_init_costf1.f, s_costf1.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Same as <code class="filename">s_map_data.f</code> but for inner core.</td></tr></tbody></table></div><p title="s_mapDataR.f"><strong>s_mapDataR.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_mapData.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_horizontal.f, c_radial.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_init_costf1.f, s_costf1.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Same as <code class="filename">s_map_data.f</code> but for inner core.</td></tr></tbody></table></div><p title="s_openFiles.f"><strong>s_openFiles.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">magic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_logic.f, c_output.f, c_init_fields.f, c_parallel.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Defines names and units for the output files and opens them.</td></tr></tbody></table></div><p title="s_outMisc.f"><strong>s_outMisc.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_output.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_num_param.f, c_phys_param.f, c_logic.f, c_output.f, c_blocking.f, c_const.f, c_radial.f, c_horizontal.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_lmAS2pt.f, s_getEgeos.f, s_pos_at_end (in l_usefull.f)</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates and writes various output parameters time series.</td></tr></tbody></table></div><p title="s_outOmega.f"><strong>s_outOmega.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_output.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_logic.f, c_const.f, c_output.f, c_radial.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_costf1.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Writes the output of axisymmetric zonal flow into a file.</td></tr></tbody></table></div><p title="s_outTO.f"><strong>s_outTO.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_output.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_horizontal.f, c_num_param.f, c_phys.param.f, c_radial.f, c_logic.f, c_output.f, c_TO.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_legtfAS2.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">One-dimensional array for storage of the fields (forces and zonal flow) and 'TO' output files.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Writes the output of axisymmetric zonal flow, its relative strength, its time variation and all forces acting on it into a file.</td></tr></tbody></table></div><p title="s_output.f"><strong>s_output.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_step_time.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_phys.param.f, c_num_param.f, c_logic.f, c_output.f, c_radial.f, c_horizontal.f, c_const.f, c_fields.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_dtBLMfinish.f, s_graphOut_IC.f, s_rBrSpec.f, s_rBpSpec.f, s_logWrite.f, s_write_movie_frame.f, s_write_Bcmb.f, s_write_coeff_r.f, s_outMisc.f, s_write_rot.f, s_get_e_kin.f, s_get_e_mag.f, s_spectrum_average.f, s_fields_average.f, s_pos_at_end (in l_usefull.f), s_get_power.f, s_getDlm.f, s_get_u_square.f, s_safeOpen (in safeOut.f), s_safeClose (in safeOut.f), s_spectrum.f, s_storePot.f, s_outTO.f, s_zeroRms.f, s_dtVrms.f, s_dtBrms.f, s_dble2string (l_char_manip.f), s_store.f, s_outOmega.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Subroutine that controls most of the output of the program.</td></tr></tbody></table></div><p title="s_parallel.f"><strong>s_parallel.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">magic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">c_parallel.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Returns the number of the thread that is executing the function (between 0, the master thread, and <span class="emphasis"><em>omp_get_num_thread()-1</em></span>).</td></tr></tbody></table></div><p title="s_plm_theta.f"><strong>s_plm_theta.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">l_lnPAS2tr.f, s_getEgeos.f, s_horizontal.f, s_outTO.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">One-dimensional arrays of the associated Legendre polynomials at a given theta and of their derivatives in order to theta.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates associated Legendre function P<sub>lm</sub>(cosθ) and the derivative sinθ∂<sub>θ</sub>P<sub>lm</sub>(cosθ) at the required colatitude points up to degree and order l<sub>max</sub>.</td></tr></tbody></table></div><p title="s_preCalc.f"><strong>s_preCalc.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">magic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_phys_param.f, c_num_param.f, c_const.f, c_radial.f, c_horizontal.f, c_init_fields.f, c_blocking.f, c_logic.f, c_output.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_radial.f, s_get_dr.f, s_horizontal.f, s_logWrite.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Performs preparatory work to be done before the time stepping like defining the initial field and calculating functions and constants needed later.</td></tr></tbody></table></div><p title="s_preCalcTimes.f"><strong>s_preCalcTimes.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">magic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_logic.f, c_num_param.f, c_output.f, c_init_fields.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_get_hit_times.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Precalc after time, time and dt has been read from startfile.</td></tr></tbody></table></div><p title="s_rBpSpec.f"><strong>s_rBpSpec.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_get_dtBLMfinish.f, s_output.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_horizontal.f, c_radial.f, c_num_param.f, c_phys.param.f, c_output.f, c_logic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_pos_at_end (in l_usefull.f)</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">Two-dimensional arrays with the toroidal and the axisymmetric toroidal energies, per order and degree, for each radial level of the total core.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates the toroidal energies (axisymmetric and total) of the total core (radial levels of inner core+radial levels of outer core).</td></tr></tbody></table></div><p title="s_rBrSpec.f"><strong>s_rBrSpec.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_get_dtBLMfinish.f, s_output.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_horizontal.f, c_radial.f, c_num_param.f, c_phys.param.f, c_output.f, c_logic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_pos_at_end (l_usefull.f)</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">Two-dimensional arrays with the poloidal and the axisymmetric poloidal energies, per order and degree, for each radial level of the total core.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates the poloidal energies (axisymmetric and total) of the total core (radial levels of inner core+radial levels of outer core).</td></tr></tbody></table></div><p title="s_radial.f"><strong>s_radial.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_prepCalc.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_num_param.f, c_phys_param.f, c_logic.f, c_output.f, c_radial.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_cheb_x_map_e_xr.f, s_get_chebs.f, s_init_costf1.f, s_check_dim (in l_usefull.f), s_cheb_x_map_e.f, s_get_chebs_even.f, s_init_costf2.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">Arrays related to the radial grid, declared in the common block <code class="filename">c_radial.f</code>.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Prepares radial functions.</td></tr></tbody></table></div><p title="s_radialLoopG.f"><strong>s_radialLoopG.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_step_time.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_parallel.f, c_phys.param.f, c_num_param.f, c_logic.f, c_output.f, c_radial.f, c_horizontal.f, c_const.f, c_TO.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_graphOut.f, s_legPrepG.f, s_legTF2.f, s_legTF3.f, s_legTFG.f, s_legTFGnomag.f, s_fft_thetab.f, s_v_rigid_boundary.f, s_get_nl.f, s_get_br_v_bcs.f, s_get_lorentz_torque.f, s_courant.f, s_getHelLM.f, s_store_movie_frame.f, s_get_dtBLM.f, s_getTOnext.f, s_getTO.f, s_get_td.f, s_getTOfinish.f, s_get_dH_dtBLM.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Subroutine that performs the actual time-stepping.</td></tr></tbody></table></div><p title="s_readNamelists.f"><strong>s_readNamelists.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">magic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_parallel.f, c_phys.param.f, c_num_param.f, c_logic.f, c_init_fields.f, c_output.f, c_TO.f, c_Grenoble.f, c_radial.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_defaultNamelists.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Reads the input namelists.</td></tr></tbody></table></div><p title="s_readStartFields.f"><strong>s_readStartFields.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_getStartFields.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_phys.param.f, c_init_fields.f, c_const.f, c_logic.f, c_radial.f, c_output.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_mapData.f, s_mapDataIC.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Reads initial conditions from a restart file.</td></tr></tbody></table></div><p title="s_s_cond.f"><strong>s_s_cond.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_getStartFields.f, s_initS.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_horizontal.f, c_phys_param.f, c_radial.f, c_mat.f, c_init_fields.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_sgefa.f, s_cgesl.f, s_costf1.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">One-dimensional array with the entropy of the conductive mode l,m=0,0, for each radial level.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Solves diffusion equation for the horizontally homogeneous entropy con­tribution (<span class="emphasis"><em>l=0,m=0</em></span>) according to the heat source chosen.</td></tr></tbody></table></div><p title="s_sgefa.f"><strong>s_sgefa.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_get_bMat.f, s_get_s0Mat.f, s_get_sMat.f, s_get_wpMat.f, s_get_z10Mat.f, s_get_zMat.f, s_initS.f, s_j_cond.f, s_s_cond.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">LU-decomposed matrix, one-dimensional array of pivot pointers (integers) and error message as an integer value (when it is different from zero, there is an error).</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Performs LU-decomposition via Gaussian elimination. Goes back to the LINPACK.</td></tr></tbody></table></div><p title="s_sgesl.f"><strong>s_sgesl.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_initS.f, s_updateS.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">One-dimensional array, which is the solution of 'Ax=b'.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Backsubstitution of LU-decomposed matricies for linear equation system for one real RHS.</td></tr></tbody></table></div><p title="s_spectrum.f"><strong>s_spectrum.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_output.f, s_fields_average.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_num_param.f, c_horizontal.f, c_phys_param.f, c_radial.f, c_logic.f, c_output.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">One-dimensional arrays of the energies (magnetic and kinetic, toroidal and poloidal), per order and per degree.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Calculates spectra of kinetic and magnetic energy and writes these to the appropriate output files.</td></tr></tbody></table></div><p title="s_spectrum_average.f"><strong>s_spectrum_average.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_output.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_num_param.f, c_horizontal.f, c_phys_param.f, c_radial.f, c_logic.f, c_output.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">s_safeOpen (in s_safeOut.f), s_safeClose (in s_safeOut.f)</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">Two-dimensional arrays of the average poloidal and toroidal energies, per order and per degree, at each radial level.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left"> </td></tr></tbody></table></div><p title="s_step_time.f"><strong>s_step_time.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">magic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_phys_param.f, c_num_param.f, c_init_fields.f, c_const.f, c_radial.f, c_horizontal.f, c_logic.f, c_output.f, c_movie.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_capitalize (in l_char_manip.f), s_wallTime (in l_timing.f), s_logWrite.f, s_dble2string (in l_char_manip.f), s_int2string (in l_char_manip.f), s_safeClose (in safeOut.f), s_safeOpen (in safeOut.f), s_radialLoopG.f, s_subTime (in l_timing.f), s_addTime (in l_timing.f), s_output.f, s_get_b_nl_bcs.f, s_dt_courant.f, s_check_time_hits.f, s_LMLoop.f, s_meanTime (l_timing.f), s_writeTime (in l_timing.f)</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">This subroutine performs the actual time stepping. Nearly all action inclu­ding the output branches off from this routine.</td></tr></tbody></table></div><p title="s_store.f"><strong>s_store.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_output.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_phys_param.f, c_num_param.f, c_radial.f, c_logic.f, c_output.f, c_init_fields.f, c_dt_fieldsLast.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Writes all necessary information into a restart file (see above).</td></tr></tbody></table></div><p title="s_storePot.f"><strong>s_storePot.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_output.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_radial.f, c_output.f, c_phys_param.f, c_horizontal.f, c_logic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_costf1.f, s_int2string (in l_char_manip.f)</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Writes all necessary information into a restart file (see above).</td></tr></tbody></table></div><p title="s_storePotW.f"><strong>s_storePotW.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_fields_average.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_radial.f, c_output.f, c_phys_param.f, c_horizontal.f, c_logic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_costf1.f, s_int2string (in l_char_manip.f)</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Writes all necessary information into a restart file (see above).</td></tr></tbody></table></div><p title="s_store_movie_frame.f"><strong>s_store_movie_frame.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_radialLoopG.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_output.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_get_B_surface.f, s_get_fl.f, s_store_fields_sur (in s_store_movie_frame.f), s_store_fields_3d (in s_store_movie_frame.f), s_store_fields_r (in s_store_movie_frame.f), s_store_fields_t (in s_store_movie_frame.f), s_store_fields_p (in s_store_movie_frame.f)</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Store all fields required for the current frame of all movies in work array.</td></tr></tbody></table></div><p title="s_store_movie_frame_IC.f"><strong>s_store_movie_frame_IC.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_output.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_logic.f, c_output.f, c_movie.f, c_dtB.f, c_radial.f, c_horizontal.f, c_phys_param.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_legPrep_IC.f, s_legTF.f, s_fft_thetab.f, s_get_fl.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Store all fields required for the current frame of all movies in work array.</td></tr></tbody></table></div><p title="s_updateB.f"><strong>s_updateB.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_LMLoop.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_horizontal.f, c_phys_param.f, c_num_param.f, c_init_fields.f, c_logic.f, c_radial.f, c_mat.f, c_RMS.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_get_drNS.f, s_get_bMat.f, s_cgeslML.f, s_costf1.f, s_get_ddr.f, s_get_ddr_even.f, s_hInt2Pol.f, s_hInt2Tor.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">Two-dimensional arrays with updated fields, first and second radial derivatives and time derivative of poloidal and toroidal components of the magnetic field.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Updates the magnetic field potentials of inner and outer core by perfor­ming the actual time step. Next explicit time step is prepared.</td></tr></tbody></table></div><p title="s_updateS.f"><strong>s_updateS.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_LMLoop.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_horizontal.f, c_phys_param.f, c_radial.f, c_logic.f, c_output.f, c_init_fields.f, c_const.f, c_mat.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_get_dr.f, s_get_s0Mat.f, s_sgesl.f, s_get_sMat.f, s_cgeslML.f, s_costf1.f, s_get_ddr.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">Two-dimensional arrays with the updated scalar fields of entropy, radial derivative of entropy and time derivative of entropy.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Updates the entropy field and its radial derivatives, and adds the explicit part to the time derivatives of the entropy field.</td></tr></tbody></table></div><p title="s_updateWP.f"><strong>s_updateWP.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_LMLoop.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_num_param.f, c_phys_param.f, c_radial.f, c_horizontal.f, c_logic.f, c_mat.f, c_RMS.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_get_wpMat.f, s_cgeslML.f, s_costf1.f, s_get_dr.f, s_get_dddr.f, s_hInt2Pol.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">Two-dimensional array with updated field of poloidal flow, first and second radial derivatives and time derivative. Two-dimensional array with updated scalar field of pressure, radial derivative and time derivative.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Updates the poloidal velocity potential and the pressure by performing the actual time step. Next explicit time step is prepared.</td></tr></tbody></table></div><p title="s_updateZ.f"><strong>s_updateZ.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_LMLoop.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_phys_param.f, c_num_param.f, c_const.f, c_radial.f, c_horizontal.f, c_logic.f, c_init_fields.f, c_mat.f, c_RMS.f, c_TO.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_get_z10Mat.f, s_cgesl.f, s_get_zMat.f, s_cgeslML.f, s_costf1.f, s_get_ddr.f, s_get_angular_moment.f, s_hInt2Tor.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">Two-dimensional arrays with the updated fields of toroidal flow, radial derivative of toroidal flow, time derivative of toroidal flow and rotation rates of inner core and mantle.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Updates the toroidal velocity potential by performing the actual time step. Next explicit time step is prepared.</td></tr></tbody></table></div><p title="s_v_rigid_boundary.f"><strong>s_v_rigid_boundary.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_radialLoopG.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_radial.f, c_horizontal.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Output:  </strong></span></td><td align="left">Two-dimensional arrays with the radial, meridional and zonal velocities at the boundaries and their derivatives.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Sets velocities at the boundaries if rigid boundary condition have been cho­sen.</td></tr></tbody></table></div><p title="s_writeInfo.f"><strong>s_writeInfo.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">magic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_phys_param.f, c_num_param.f, c_logic.f, c_init_fields.f, c_output.f, c_const.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_pos_at_end (in l_usefull.f)</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Writes the namelist to a file, which has to be opened before calling this subroutine.</td></tr></tbody></table></div><p title="s_writeNamelists.f"><strong>s_writeNamelists.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">magic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_phys_param.f, c_num_param.f, c_logic.f, c_init_fields.f, c_output.f, c_const.f, c_parallel.f, c_Grenoble.f, s_radial.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Writes the namelist into an output file, which has to be opened before opening this subroutine.</td></tr></tbody></table></div><p title="s_write_Bcmb.f"><strong>s_write_Bcmb.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_fields_average.f, s_output.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Every time this subroutine is called, it writes the time and the poloidal magnetic potential coefficients at the CMB up to a certain degree and order, at the end of an output file.</td></tr></tbody></table></div><p title="s_write_coeff_r.f"><strong>s_write_coeff_r.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_output.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Every time this subroutine is called, it writes the time and the poloidal velocity coefficients at a specific radius up to a certain degree and order, at the end of an output file.</td></tr></tbody></table></div><p title="s_write_dtB_frame.f"><strong>s_write_dtB_frame.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_write_movie_frame.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_output.f, c_blocking.f, c_radial.f, c_horizontal.f, c_dtB.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_get_dtB.f, s_get_drNS.f, s_get_Bpol.f, s_get_Btor.f, s_lm2pt.f, s_get_drNS_even.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Controls the output of movie frames.</td></tr></tbody></table></div><p title="s_write_movie_frame.f"><strong>s_write_movie_frame.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_output.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_radial.f, c_horizontal.f, c_phys_param.f, c_num_param.f, c_output.f, c_logic.f, c_movie.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_pos_at_end (in l_usefull.f), s_write_dtB_frame.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Writes the stored movie frames (<code class="filename">s_store_movie_frame.f</code>) into the respecti­ve movie-files.</td></tr></tbody></table></div><p title="s_write_rot.f"><strong>s_write_rot.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_output.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_num_param.f, c_phys_param.f, c_logic.f, c_radial.f, c_output.f, c_const.f, c_horizontal.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_get_viscous_torque.f, s_pos_at_end (in l_usefull.f), s_get_angular_moment.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Writes rotation-information into the appropriate file (see above).</td></tr></tbody></table></div><p title="s_zeroRms.f"><strong>s_zeroRms.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_output.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">truncation.f, c_blocking.f, c_RMS.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Sets the integrals from <code class="filename">s_get_td.f</code>, <code class="filename">s_update*.f</code> and <code class="filename">s_dt*rms.f</code> to zero.</td></tr></tbody></table></div><p title="f_cc.f"><strong>f_cc.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Functions / subroutines:  </strong></span></td><td align="left">f_cc2real; f_cc22real</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_getDlm.f, s_getStartFields.f, s_PolTorRms.f, s_get_e_kin.f, s_get_e_mag.f, s_hInt2Tor.f, s_rBpSpec.f, s_rBrSpec.f, s_spectrum.f, s_spectrum_average.f; s_get_e_mag.f, s_get_power.f, s_spectrum.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left"> </td></tr></tbody></table></div><p title="f_rInt.f"><strong>f_rInt.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_dtBrms.f, s_getB0.f, s_getDlm.f, s_get_PolTorRms.f, s_get_angular_moment.f, s_get_e_kin.f, s_get_e_mag.f, s_get_power.f, s_outMisc.f, s_outTO.f; s_spectrum.f, s_spectrum_average.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_costf1.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Performs the radial integral over a function given in the appropriate radial Chebyshev grid points.</td></tr></tbody></table></div><p title="f_rInt_R.f"><strong>f_rInt_R.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_dtVrms.f, s_getDlm.f, s_get_angular_moment.f, s_get_e_kin.f, s_get_e_mag.f, s_get_power.f, s_outMisc.f, s_outTO.f; s_spectrum.f, s_spectrum_average.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Common blocks used:  </strong></span></td><td align="left">c_logic.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_costf1.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Performs the radial integral over a function given in the appropriate radial Chebyshev grid points, using a mapping function that depends on radius.</td></tr></tbody></table></div><p title="f_rIntIC.f"><strong>f_rIntIC.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_get_e_mag.f, s_get_power.f, s_spectrum.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Calls:  </strong></span></td><td align="left">s_costf1.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Performs the radial integral over a function given in the appropriate radial Chebyshev grid points (for the inner ore).</td></tr></tbody></table></div><p title="f_random.f"><strong>f_random.f. </strong></p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>Called by:  </strong></span></td><td align="left">s_initB.f, s_initS.f, s_initV.f</td></tr><tr><td align="left" valign="top"><span class="command"><strong>Task:  </strong></span></td><td align="left">Random generator for initialisation of the entropy field.</td></tr></tbody></table></div></div><div class="section" title="Common-blocks"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id561887"></a>Common-blocks</h2></div></div></div><p>
		Generally (nearly) all common are supplied in files with the prefix <code class="filename">c_</code>. They are included in the code at compilation.
	</p><p>
		</p><div class="informaltable"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td align="left" valign="top"><span class="command"><strong>c_Grenoble.f  </strong></span></td><td align="left">Contains all variables for the case of an imposed IC dipole.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>c_RMS.f  </strong></span></td><td align="left">Contains blocking information for RMS calculation.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>c_TO.f  </strong></span></td><td align="left">Contains blocking information for TO calculation and output.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>c_blocking.f  </strong></span></td><td align="left">Contains blocking information used to speed up the run.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>c_const.f  </strong></span></td><td align="left">Contains several constants like π, moments of inertia of mantle and inner core ...</td></tr><tr><td align="left" valign="top"><span class="command"><strong>c_dtB.f  </strong></span></td><td align="left">Contains blocking information about magnetic stretching and advection terms plus a separate omega-effect.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>c_dt_fieldsLast.f  </strong></span></td><td align="left">Contains the variables provided by the restart file or calculated here, for the first time step, or by updated routines, for the next time step (the variables have he sufix -Last and remain in LM space).</td></tr><tr><td align="left" valign="top"><span class="command"><strong>c_fft_own.f  </strong></span></td><td align="left">Information needed for fourier transform.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>c_fields.f  </strong></span></td><td align="left">All fields including their radial derivatives.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>c_horizontal.f  </strong></span></td><td align="left">Precomputed functions of colatitude and longitude plus functions of the spherical degree and order.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>c_init_fields.f  </strong></span></td><td align="left">Contains information about the start fields.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>c_logic.f  </strong></span></td><td align="left">Contains several logical flags that control the run.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>c_mat.f  </strong></span></td><td align="left">Contrains all LU-decomposed inversion matricies for the implicit time step.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>c_movie.f  </strong></span></td><td align="left">Contains the work arrays.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>c_num_param.f  </strong></span></td><td align="left">Contains numerical parameters.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>c_output.f  </strong></span></td><td align="left">Contains information on output.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>c_parallel.f  </strong></span></td><td align="left">Contains blocking information.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>c_phys_param.f  </strong></span></td><td align="left">Contains physical parameters.</td></tr><tr><td align="left" valign="top"><span class="command"><strong>c_radial.f  </strong></span></td><td align="left">Contains precomputed radial functions.</td></tr></tbody></table></div><p>
	</p></div></div></div></body></html>
